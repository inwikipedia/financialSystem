/*!
 * 
 * Spread.Sheets Library 12.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Outlines=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";c(1);var b=c(4);b.SR={},b.SR.en=c(5),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p=c(2),q=c(3),r=q.Commands,s=r.ActionBase,t=q.GC$,u="outlineColumn",v="removeColumnOutline",w="expandColumnOutline",x="expandColumnOutlineForLevel",y="outlineRow",z="removeRowOutline",A="expandRowOutline",B="expandRowOutlineForLevel",C=p.j.Fa;function D(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function E(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=D(g),b&&e&&!C(c)&&!C(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}b=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return E.call(this,!0)},undo:function(){return E.call(this,!1)}};return t.extend(b.prototype,c),b}(s),d=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(b),e=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(b),f=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d=this,e=d.kj,f=!1;return d.canExecute()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),e&&c&&!C(a)&&!C(b)&&((c.getLevel(a)>=0||c.getLevel(a+b-1)>=0)&&(d.Lz(e,!0),c.ungroupRange(a,b),d.Mz(e,!0)),f=!0)),f},undo:function(){var a,b,c,d=this,e=!1,f=d.kj;return d.canUndo()&&(a=d.VQ.index,b=d.VQ.count,c=D(d),f&&c&&!C(a)&&!C(b)&&(d.Lz(f,!0),c.group(a,b),d.Mz(f,!0),e=!0)),e}};return t.extend(b.prototype,c),b}(s),g=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(f),h=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(f);function F(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a.zoom();return f}function G(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a.zoom();return b>=d?d-1:b}function H(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function I(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.kj,s=c.index,t=b?r.getRowCount():r.getColumnCount(),u=void 0;s<0||s>=t||(d=D(q),e=1===d.direction(),f=b?r.frozenRowCount():r.frozenColumnCount(),g=b?r.getRowHeight:r.getColumnWidth,h=b?r.getViewportTopRow:r.getViewportLeftColumn,i=b?r.getViewportHeight:r.getViewportWidth,j=h.call(r,1),n=d.find(e?s-1:s+1,c.level),n&&(o=e?n.start:s,p=e?s:n.end,e?(a?o=s:o<f&&(o=f),o<j&&(j=o),k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(j=G(r,j,l-k,t,g)),m=H(r,j,g,f,t-1)):(a?p=s:p>=t&&(p=t-1),o<j?m=H(r,o,g,f,t-1):(k=i.call(r,1),l=F(r,j,p,t,g),l>k&&(m=H(r,o,g,f,t-1)))),b&&m!==u?(r.lq=m,r.os()):b||m===u||(r.qq=m,r.qs())))}function J(a){var b,c,d,e,f,g,h,i=this,j=!1;return(a?i.canExecute():i.canUndo())&&(b=i.kj,c=i.VQ,d=D(i),e=c.collapsed,f=c.index,g=c.level,!b||!d||C(e)||C(f)||C(g)||(i.Lz(b,!0),a||(e=!e),h=1===d.direction()?d.find(f-1,g):d.find(f+1,g),h&&d.setCollapsed(f,e),I.call(i,e,i.ML,c),i.Mz(b,!0),j=!0)),j}i=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){return J.call(this,!0)},undo:function(){return J.call(this,!1)}};return t.extend(b.prototype,c),b}(s),j=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(i),k=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(i),l=function(a){t.inherit(b,a);function b(b,c,d){var e=this;a.call(e),e.kj=b,e.VQ=c,e.ML=d}var c={execute:function(){var a,b,c,d,e=this,f=e.kj,g=!1;if(e.canExecute()&&(b=e.VQ.level,c=D(e),f&&c&&!C(b))){for(f.ITa.startTransaction(),e.Lz(f,!0),a=0;a<b;a++)c.expand(a,!0);c.expand(b,!1),e.Mz(f,!0),d=r.bWa(f.name()),e.VQ[d]=f.ITa.endTransaction(),g=!0}return g},undo:function(){var a,b,c,d=this,e=!1;return d.canUndo()&&(a=d.kj,b=r.bWa(a.name()),c=d.VQ[b],a&&c&&(d.Lz(a,!0),a.ITa.undo(c),e=!0,d.Mz(a,!0))),e}};return t.extend(b.prototype,c),b}(s),m=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!1)}return b}(l),n=function(a){t.inherit(b,a);function b(b,c){a.call(this,b,c,!0)}return b}(l),o=r.h4,r[u]={canUndo:!0,execute:function(a,b,c){return o(a,d,b,c)}},r[y]={canUndo:!0,execute:function(a,b,c){return o(a,e,b,c)}},r[v]={canUndo:!0,execute:function(a,b,c){return o(a,g,b,c)}},r[z]={canUndo:!0,execute:function(a,b,c){return o(a,h,b,c)}},r[w]={canUndo:!0,execute:function(a,b,c){return o(a,j,b,c)}},r[A]={canUndo:!0,execute:function(a,b,c){return o(a,k,b,c)}},r[x]={canUndo:!0,execute:function(a,b,c){return o(a,m,b,c)}},r[B]={canUndo:!0,execute:function(a,b,c){return o(a,n,b,c)}},r.SL=function(a){a.register(u,r[u]),a.register(y,r[y]),a.register(v,r[v]),a.register(z,r[z]),a.register(w,r[w]),a.register(A,r[A]),a.register(x,r[x]),a.register(B,r[B])},a.exports=r}()},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h=c(2),i=c(3),j=c(1),k={},l=null,m=void 0,n=Math.max,o=Math.min,p=Math.round,q=Math.ceil,r=i.GC$,s=r.each,t=i.Im.Lm,u=i.Worksheet,v=i.Rect,w=h.k,x=w._b,y=w.$b,z=w.ac,A=8.25,B=17,C=4,D=i.Ul.Ol,E=h.j.Fa,F=i.Ul.Pl,G=i.Ul.fp,H="rangegroup",I="gc-group",J=I+"-box",K=J+"-expand",L=J+"-collapsed",M=I+"-line",N=I+"-dot",O="rgh",P="cgh",Q="rg",R="cg",S=function(){return h.C(k.SR)()},T={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a=h.options,b=a.sheetAreaOffset,c={x:b.left,y:b.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},d=h.rowOutlines,e=h.columnOutlines,f=B*h.zoom(),h.showRowOutline()&&d&&!d.iT()&&(g=d.getMaxLevel(),g>=0&&(c.width=f*(g+2)+C,c.rowMaxLevel=g)),h.showColumnOutline()&&e&&!e.iT()&&(g=e.getMaxLevel(),g>=0&&(c.height=f*(g+2)+C,c.colMaxLevel=g)),h.TL=c,c)},showRowOutline:F("showRowOutline",!0,function(){this.$p()}),showColumnOutline:F("showColumnOutline",!0,function(){this.$p()})};r.extend(i.Worksheet.prototype,T);function U(a,b){a.Wq(i.Events.RangeGroupStateChanging,b)}function V(a,b){a.Wq(i.Events.RangeGroupStateChanged,b)}function W(a,b){var c,d,e,f;a.isEditing&&a.isEditing()||(c=b.info.index,d=b.what===O,e=d?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",f=Y(a,d,-1,c,!0),U(a,f),f&&f.cancel===!1&&(a.wu().execute({cmd:e,sheetName:a.name(),level:c}),V(a,Y(a,d,-1,c,!1))))}function X(a,b){var c,d,e,f,g,h,i;a.isEditing&&a.isEditing()||(c=b.what===Q,ba(c,a)&&(d=b.info,e=d.index,f=e,g=d.level,i=c?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?e--:e++,h=Y(a,c,e,g,!0),U(a,h),h&&h.cancel===!1&&(a.wu().execute({cmd:i,sheetName:a.name(),index:f,level:g,collapsed:d.isExpanded}),V(a,Y(a,c,e,g,!1)))))}function Y(a,b,c,d,e){var f={sheet:a,sheetName:a.name(),isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function Z(a,b){var c,d,e,f,g=this,h=g.Gt(),i=h.width,j=h.height;return i||j?(c=g.am(),d=new v(h.x,h.y,i,c.height),e=new v(h.x,h.y,c.width,j),d.contains(a,b)||e.contains(a,b)?(f=$(g,a,b,h.rowMaxLevel,!0),f||(f=$(g,a,b,h.colMaxLevel,!1)),f||{what:"empty",info:l}):l):l}function $(a,b,c,d,e){var f,g,h=new qa(a,e,d),i=h.WL(b,c,e);if(i)return{what:e?O:P,info:i};for(f=_(a,e,d),g=0;g<=2;g++)if(i=f[g].XL(b,c,e))return{what:e?Q:R,info:i};return l}function _(a,b,c){var d=[new pa(a,b,0,c),new pa(a,b,1,c),new pa(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function aa(a,b){var c=b?a.width:a.height;return n(0,(c-2*this.PADDING)/(this.ZL+2))}function ba(a,b){return a?b.rowOutlines:b.columnOutlines}k.OutlineDirection={backward:0,forward:1},k.OutlineState={expanded:0,collapsed:1},b=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=l,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype={state:function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},contains:function(a){return this.start<=a&&a<=this.end},addChild:function(a){a&&(this.children.push(a),a.parent=this)}},a}(),k.OutlineInfo=b;function ca(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,g=[],e=0;e<c;e++)g.push(l);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new oa(f);ia(a)}}function da(a,b,c){c>0&&(a.items.splice(b,c),ia(a))}function ea(a,c,d){var e,f,g,h,i,j,k=l,m=a.items;for(f=c,h=z(m);f<h&&(e=m[f],!e||e.level<d||(k||(k=new b(a,f,f,d)),e.level>d&&(g=ea(a,f,d+1),f=g.index,k.addChild(g.g)),f>k.end&&(k.end=f),!a.isGroupEnd(f,d)));f++);if(k)for(i=k.end+1,j=k.start;j<i;j++)m[j].groupInfo||(m[j].groupInfo=k);return{g:k,index:f}}function fa(a,b){return b>=-1&&b<z(a.items)}function ga(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return l}function ha(a,b){switch(a){case"head":case"tail":return b===l;case"direction":return 1===b;case"itemsData":return 0===z(b);default:return!1}}function ia(a){a.Zka=l,a.refresh()}function ja(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),la(a))}function ka(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function la(a,b){a.groupChangeHandler&&a.groupChangeHandler(b)}function ma(a,b,c){if(na(a,b),!fa(a,b+c-1))throw Error(S().Exp_InvalidCount)}function na(a,b){if(!fa(a,b))throw Error(S().Exp_InvalidIndex)}d=function(){function a(a,b,c){var d=this;d.head=l,d.tail=l,d.Zka=l,d.items=Array(a),d.V3=0,d.wz=!0,d.kj=b,d.ML=c}return a.prototype={direction:F("direction",1),group:function(a,b){var c=this,d,e;for(ma(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new oa;c.Wka&&c.Zka&&(c.Zka=l),ja(c),c.wz=!1},Lia:function(){this.Wka=!0,this.Zka=l},Mia:function(){this.Wka=!1,this.refresh()},ungroupRange:function(a,b){var c=this,d,e;for(ma(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;ja(c)},ungroup:function(){var a=this,b=z(a.items);a.kj.ITa.vUa(a.ML),a.items=Array(b),ja(a),a.wz=!0},expand:function(a,b){var c,d,e,f,g;if(a<-1)throw Error(S().Exp_InvalidLevel);for(c=this,d=c.items,c.kj.ITa.vUa(c.ML),ka(c),f=0,g=d.length;f<g;f++)d[f]&&(e=c.find(f,a),e&&c.expandGroup(e,b))},expandGroup:function(a,b){if(!a)throw Error(S().Exp_GroupInfoIsNull);var c=this,d=c.direction(),e=-1;c.kj.ITa.vUa(c.ML),0===d?e=a.start-1:1===d&&(e=a.end+1),c.setCollapsed(e,!b)},Xr:function(a){return!fa(this,a)||!this.isCollapsed(a)},isCollapsed:function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},find:function(a,b){var c=this,d;return ka(c),b===-1?d=c.Zka:(na(c,a),d=ga(c,a,b)),d},getLevel:function(a){var b=this.items[a];return b?b.level:-1},getCollapsed:function(a){var b=this.items[a];return!!b&&!!b.collapsed},B4:function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new oa,f.level=-1),f.viewCollapsed=d},setCollapsed:function(a,b){var c,d,e,f,g,h,i=this,j=!1,k=i.items;if(i.kj.ITa.vUa(i.ML),ka(i),a<0?(c=i.head,c||(c=i.head=new oa)):a<z(k)?(c=k[a],c||(c=k[a]=new oa,c.level=-1)):(c=i.tail,c||(c=i.tail=new oa)),d=1===i.direction(),c.collapsed!==b&&(c.collapsed=b,j=!0,i.E4(a,b)),j&&(a+=d?-1:1,f=[],g=i.find(a,i.getLevel(a)))){for(h=g.start;h<=g.end;h++)f.push(h);e={indexes:f}}la(i,e)},dPa:function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new oa,c.level=-1,c.collapsed=b)},E4:function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.items,n=1===l.direction(),o=n?-1:1,p=a+o,q=ga(l,p,l.getLevel(p));if(q)if(b)c=n?q.end+1:q.start-1,l.dPa(c,!0),l.B4(m,q.start,q.end,!0);else{for(d=!1,e=q.parent;e;){if(f=n?e.end+1:e.start-1,m[f]&&m[f].collapsed&&m[f].level>-1){d=!0;break}e=e.parent}if(!d)for(c=n?q.end+1:q.start-1,l.dPa(c,!1),l.B4(m,q.start,q.end,!1),g=[q],h=0;h>=0;)if(i=g[h--],f=n?i.end+1:i.start-1,m[f]&&m[f].collapsed&&m[f].level!==-1)l.B4(m,i.start,i.end,!0);else for(j=i.children,k=0;j&&k<j.length;k++)g[++h]=j[k]}},getMaxLevel:function(){var a=-1,b=this.items,c;return s(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},cB:function(a,b,c,d){var e,f,g,h,i;if(!(c<=0||a===b)){for(e=this,e.kj.ITa.vUa(e.ML),a<0&&(a=0),b<0&&(b=0),f=[],g=e.items,h=x(g,a-1);h>=0&&h<a+c;)i=new oa(g[h]),f.push({index:h-a,value:i}),h=x(g,h);d&&y(g,a,c),y(g,b,c),s(f,function(a,c){g[b+c.index]=c.value}),ia(e)}},bB:function(a,b,c,d,e){var f,g,h,i=this;if(i.kj.ITa.vUa(i.ML),b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=x(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new oa(a.items[g]),g=x(a.items,g);if(y(i.items,c,d),f.length>0)for(h in f)f.hasOwnProperty(h)&&(i.items[c+h]=f[h]);e&&y(a.items,b,d)},refresh:function(){this.wz||ja(this)},VL:function(a){var b,c,d=this,e=d.items,f=z(e),g=a-f;if(g<0)e.splice(a,-g);else if(b=e[f-1])for(c=0;c<g;c++)e.push(new oa(b));else d.items=e.concat(Array(g));ia(d)},getState:function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<z(c)?c[f]:b.tail,d&&d.collapsed?1:0},Ez:function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new oa),c.head.level=b):a<z(d)?(d[a]||(d[a]=new oa),d[a].level=b):(c.tail||(c.tail=new oa),c.tail.level=b),ia(c)},suspendAdding:function(){this.V3++},resumeAdding:function(){this.V3--},createRangeGroup:function(){for(var a,c,d=this,e=d.items,f=z(d.items),g=new b(d,0,f-1,(-1)),h=0;h<f;)e[h]&&(e[h].groupInfo=l),h++;for(h=0;h<f;)e[h]?(a=ea(d,h,0),c=a.g,h=a.index+1,c&&c.level>-1&&g.addChild(c)):h++;return g},isGroupEnd:function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!fa(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},hitTest:function(a,b,c){return Z.call(a,b,c)},jp:function(a,b,c,d){var e,f,g,h,i,j,k,l=a.Gt(),m=a.am(),n=a.ss,o=l.width,p=l.height;if(o||p){if(e=d?o:m.width,f=d?m.height:p,g=d?l.rowMaxLevel:l.colMaxLevel,h=d?n.bn:n.dn,b.save(),b.beginPath(),!c||c.intersect(l.x,l.y,e,f))for(i=new qa(a,d,g),i._L(b),j=h.call(a.ss,function(){return _(a,d,g)}),k=0;k<=2;k++)j[k].aM(b);b.beginPath(),b.restore()}},UL:function(a,b){if(b){var c=b.what;c===O||c===P?W(a,b):c!==Q&&c!==R||X(a,b)}},iT:function(){return this.wz},s0a:function(){var a=parseInt(t(M).borderTopWidth);return isNaN(a)?2:a},fromJSON:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.ignoreStyle;if(a&&!n)for(c=this,d=c.items,e=a.itemsData,f=a.direction,g=a.head,h=a.tail,l=[],s(e,function(a,b){if(i=b.index,j=b.info,i>=0&&j){for(k=0;k<b.count&&!(i+k>=z(d));k++)b.info.collapsed&&l.push(b),d[i+k]=new oa(j);c.wz=!1}}),E(f)||c.direction(f),g&&(c.head=g),h&&(c.tail=h),ja(c,!0),m=0;m<l.length;m++)c.E4(l[m].index,!0)},toJSON:function(a){var b,c,d,e,f,g,h,i,j,k=a&&a.ignoreStyle;if(!k){for(b=this,c=[],d=b.items,f=-1,e=0;e<z(d);e++)g=c[f],h=d[e],h&&(f>=0&&e===g.count+g.index&&h.level===g.info.level&&h.collapsed===g.info.collapsed?c[f].count++:c[++f]={index:e,count:1,info:{level:h.level,collapsed:h.collapsed}});return i={itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},j={},s(i,function(a,b){ha(a,b)||(j[a]=b)}),r.isEmptyObject(j)?m:j}}},a}(),k.Outline=d;function oa(a){return{level:a?a.level:0,collapsed:!!a&&a.collapsed,viewCollapsed:!!a&&a.viewCollapsed}}function pa(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=D(d)?d:ba(b,a).getMaxLevel()}pa.prototype={YL:function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),s(a,function(a,c){b.gM(c)}))},gM:function(a){var b,c,d,e,f,g,h,i,j,k,m,p,q,r,t,u,v,w,x=this,y=x.kj,A=x.ML,B=ba(A,y).direction(),C=1===B,D=0===B,E=x.hM(!0,A),F=x.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&x.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=n(E,G),f=o(F,H),c&&(g={start:e,end:f,level:I,startLine:l},(C&&e===G||D&&f===H)&&(g.startLine=!0),x.bM.push(g)),j=[],k=a.children,h=e;h<=f;h++)j.push(!1);for(s(k,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(i=c;i<=d;i++)j[i-e]=!0;f=C?d+1:d-1,j[f-e]=!0,x.gM(b)}),m=!0,h=0;h<z(k);h++){if(p=k[h],q=p.start,r=p.end,t=q===G,u=r===H,t&&u){m=!1;break}if(C&&u||D&&t)for(i=q;i<=r;i++)j[i-e]=!0}if(m)for(v=e;v<=f;v++)j[v-e]||(w={index:v,level:I+1},x.cM.push(w))}}else 1===a.state()&&x.iM(!1,I,b,E,F,B)},iM:function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},jM:function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},aM:function(a){var b,c,d,e,f,g,h,i=this;i.ZL!==-1&&(b=i.kj.Gt(),c=i.ML,d=aa.call(i,b,c),d&&(e=parseInt(t(M).borderTopWidth),e=isNaN(e)?2:e,f=p(d/3),g=i.PADDING,h=(d-e)/2+g,a.save(),a.fillStyle=t(I).color,i.kM(a,i.cM,c,b,d,h,e),c?i.D_a(a,i.bM,c,b,d,h,e,f):i.E_a(a,i.bM,c,b,d,h,e,f),i.mM(a,i.dM,c,b,d,h,e,g),a.beginPath(),a.restore()))},kM:function(a,b,c,d,e,f,g){var h,i,j,k=this,l=2,m=k.kj,o=m.options,p=o.sheetAreaOffset,q=p.left,r=p.top;a.save(),a.fillStyle=t(N).color,j=k.bM,s(b,function(b,m){var o,p,s,t,u,v,w=m.index,x=m.level;k.C0a(j,w,x)||(o=k.jM(w),o&&(p=c?o.y:o.x,s=(c?o.height:o.width)-g,s>=0&&(h=p+n(0,s/2),i=m.level*e+f,c?(t=h,h=i+.5,i=t,i-=r):(i+=.5,h-=q),a.strokeStyle="transparent",a.lineWidth=0,u=d.x+h,v=d.y+i,u%1!==0&&(u+=.5),v%1!==0&&(v+=.5),a.strokeRect(u,v,l,l),a.fillRect(u,v,l,l))))}),a.restore()},C0a:function(a,b,c){var d,e=!1,f=z(a);for(d=0;d<f;d++)if(a[d].level===c&&a[d].start<=b&&a[d].end>=b){e=!0;break}return e},D_a:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,o,p,r,s,u,v,w,x,y,A,B,C;for(a.save(),a.strokeStyle=t(M).borderTopColor,a.fillStyle=t(M).borderTopColor,a.lineWidth=g,i=this,j=i.kj,k=ba(c,j).direction(),m=j.options,o=m.sheetAreaOffset,p=o.top,l=0;l<z(b);l++){r=b[l],s=r.start,u=r.end;do v=i.jM(s),s++;while(!v&&s<=u);do w=i.jM(u),u--;while(!w&&u>=s);(v||w)&&(v?w||(w=v):v=w,x=v.y,y=r.level*e+f,A=g,B=n(0,w.y+w.height-v.y),1===k&&(x+=1),x=q(x)+.5,x-=p,a.beginPath(),C=d.x+y+A/2,C=q(C),a.moveTo(C,d.y+x),a.lineTo(C,d.y+x+B),a.stroke(),r.startLine&&e/2-2*g>0&&(0===k&&(x=x+B-g-p),x>=v.y-p&&x<w.y+w.height-p&&a.fillRect(q(d.x+y),d.y+x,h,g)))}a.restore()},E_a:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,o,p,r,s,u,v,w,x,y,A,B;for(a.save(),a.strokeStyle=t(M).borderTopColor,a.fillStyle=t(M).borderTopColor,a.lineWidth=g,i=this,j=i.kj,k=ba(c,j).direction(),m=j.options,o=m.sheetAreaOffset,p=o.left,l=0;l<z(b);l++){r=b[l],s=r.start,u=r.end;do v=i.jM(s),s++;while(!v&&s<=u);do w=i.jM(u),u--;while(!w&&u>=s);(v||w)&&(v?w||(w=v):v=w,x=v.x,y=r.level*e+f,A=n(0,w.x+w.width-v.x),1===k&&(x+=1),x-=p,B=d.y+y+g/2,B=q(B),a.beginPath(),a.moveTo(d.x+x,B),a.lineTo(d.x+x+A,B),a.stroke(),r.startLine&&e/2-2*g>0&&(0===k&&(x=x+A-g-p),x>=v.x-p&&x<w.x+w.width-p&&a.fillRect(d.x+x,q(d.y+y),g,h)))}a.restore()},r0a:function(a){var b=t(a).backgroundImage;return"none"===b&&(b=""),b&&(b=b.split(",")[0],b=b.replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1"),b=b.trim()),b},mM:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,p,r,s,u,v,w,x,y,A,B,C,D,E,F,G,H,I,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=this,$=Z.kj,_=$.options,aa=_.sheetAreaOffset.left,ba=_.sheetAreaOffset.top,ca=t(J).borderTopColor,da=t(J).backgroundColor,ea=t(J).color,fa=t(M).borderTopColor,ga=1,ha=$.vu(),ia=Z.r0a(K),ja=Z.r0a(L);for(ia&&!ha.ko(ia)&&ha.fo(ia),ja&&!ha.ko(ja)&&ha.fo(ja),j=ja&&ha.lo(ja),k=ia&&ha.lo(ia),l=t(K),m=t(L),p=k?l.backgroundColor:"",r=j?m.backgroundColor:"",s=k?l.borderTopColor:"",u=j?m.borderTopColor:"",i=0;i<z(b);i++)a.save(),A=b[i],B=Z.jM(A.index),B?(C=c?B.height:B.width,C<=0?a.restore():(D=n(0,(C-e)/2),G=(c?B.y-ba:B.x-aa)+D,H=A.level*e+h,I=o(e,C),N=e,Q=C-I,c?(R=G,G=H,H=R,S=I,I=N,N=S,O=.5,P=0):(O=0,P=.5),x=A.isExpanded?s:u,a.strokeStyle=x?x:ca,a.lineWidth=ga,w=A.isExpanded?p:r,w?a.fillStyle=w:a.fillStyle=da,a.fillRect(d.x+G,d.y+H,I,N),E=d.x+G+O,F=d.y+H+P,a.strokeRect(E,F,I,N),a.fillStyle=ea,v=A.isExpanded?ia:ja,Z.nM(a,A.isExpanded,v,E,F,I,N),a.restore(),A.paintLine&&Q>0&&(a.save(),a.strokeStyle=fa,G=c?B.y-ba:B.x-aa,H=A.level*e+f,T=0===A.lineDirection,U=c?g:D,V=c?D:g,c?(W=G,G=H,H=W,T&&(H+=D+N,V=Q-D)):T&&(G+=D+I,U=Q-D),a.beginPath(),a.lineWidth=g,X=q(d.x+G+g/2),Y=q(d.y+H+g/2),c?(a.moveTo(X,d.y+H),a.lineTo(X,d.y+H+V-ga)):(y=0,j&&!A.isExpanded&&(y=1),a.moveTo(d.x+G,Y),a.lineTo(d.x+G+O+U+y,Y)),a.stroke(),a.restore()))):a.restore()},nM:function(a,b,c,d,e,f,g){var h,i,j,k=this,l=this.kj,m=l.vu();if(c&&m.ko(c)){h=m.lo(c),i=h.width,j=h.height;try{a.drawImage(h,0,0,i,j,p(d),p(e),f-1,g-1)}catch(a){}}else k.u0a(a,b,d,e,f,g)},u0a:function(a,b,c,d,e,f){var g,h,i=p(e/4),j=p(e/2);b||(g=p(f/4),h=p(f/2),a.fillRect(c+e/2-1,d+g,2,f-h)),a.fillRect(c+i,d+f/2-1,j,2)},fM:function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,k=ba(b,g),l=b?g.Gr:g.Hr,m=l.call(g,f.eM),p=z(m);for(p&&(d=m[0],e=m[p-1],i=n(0,(b?d.row:d.col)-1),j=b?o(g.getRowCount(),e.row+2):o(g.getColumnCount(),e.col+2));i<j;)c=k.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},hM:function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},oM:function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},XL:function(a,b,c){var d,e,f,g,h,i,j,k,m,p,q,r,s,t,u,w,x=this,y=x.ZL,A=x.kj,B=A.options,C=B.sheetAreaOffset.left,D=B.sheetAreaOffset.top;if(y<0)return l;if(d=A.Gt(),e=aa.call(x,d,c),!e)return l;for(f=x.dM,i=0;i<z(f);i++)if(j=f[i],k=j.index,m=j.level*e+x.PADDING,p=x.jM(k),p&&(g=c?p.height:p.width,!(g<=0)&&(q=o(e,g),r=e,s=(c?p.y-D:p.x-C)+n(0,(g-e)/2),t=m,c&&(u=q,q=r,r=u,w=s,s=t,t=w),h=new v(d.x+s+.5,d.y+t+.5,q,r),x.oM(h),h.contains(a,b))))return j;return l}};function qa(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=D(c)?c:ba(b,a).getMaxLevel()}qa.prototype={_L:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,q,r,s,u,v,w,x,y,z,B,C,D,E,F,H=this,K=H.kj,L=H.ZL;if(!(L<0)&&(b=H.ML,c=K.Gt(),d=aa.call(H,c,b),d)){if(e=L+2,f=H.PADDING,g=K.options,h=c.width,i=c.height,j=c.x,k=c.y,l=K.am(),m=l.width,o=l.height,q=l.Cr,r=l.Br,s=l.zr,u=l.Ar,a.save(),a.fillStyle=t(I).backgroundColor,a.strokeStyle=t(I).borderTopColor,a.lineWidth=1,a.fillRect(j,k,b?h:m,b?o:i),a.strokeRect(j-.5,k-.5,b?h:m+1,b?o+1:i),b?a.strokeRect(j-.5,u-.5,h,q):a.strokeRect(s-.5,k-.5,r,i),v=(b?q:r)-d,x=n(0,(b?u-g.sheetAreaOffset.top:s-g.sheetAreaOffset.left)+v/2),y=f,b&&(B=x,x=y,y=B),a.restore(),w=b?g.colHeaderVisible:g.rowHeaderVisible,a.save(),w&&v>=0)for(z=0;z<e;z++)C=d-1,E=j+x,F=k+y,b?E=p(E)+.5:F+=.5,a.fillStyle=t(J).backgroundColor,a.fillRect(E,F,C,C),a.font=A*K.zoom()+"pt Arial",a.strokeStyle=t(J).borderTopColor,a.strokeRect(E,F,C,C),a.fillStyle=t(J).color,D=G(a.font),H.pM(a,E,F,C,d,z+1,D),b?x+=d:y+=d;a.restore()}},pM:function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},WL:function(a,b,c){var d,e,f,g,h=this,i=h.kj,j=h.ZL;return j<0?l:(d=j+2,e=i.am(),f=i.options,g=f.sheetAreaOffset,c?h.qM(i,a,b,c,f.colHeaderVisible,e.Cr,e.Ar-g.top,d):h.qM(i,a,b,c,f.rowHeaderVisible,e.Br,e.zr-g.left,d))},qM:function(a,b,c,d,e,f,g,h){var j,k,m,o,p,q=this,r=a.Gt(),s=aa.call(q,r,d),t=f-s;if(s&&e&&t>=0)for(j=n(0,g+t/2),k=q.PADDING,d&&(p=j,j=k,k=p),o=0;o<h;o++){if(m=new i.Rect(r.x+j,r.y+k,s,s),m.contains(b,c))return{index:o};d?j+=s:k+=s}return l}},e=i.lUa;function ra(a){return a&&new oa(a)}function sa(a){return{items:a.items.map(ra),head:ra(a.head),tail:ra(a.tail),wz:a.wz,direction:a.direction()}}function ta(a,b){a.items=b.items.map(ra),a.head=ra(b.head),a.tail=ra(b.tail),a.wz=b.wz,a.direction(b.direction),ja(a,!0)}r.extend(e.prototype,{vUa:function(a){var b=this,c=b.zTa;c&&(c.wUa||(c.wUa=[]),a&&!c.wUa[0]?c.wUa[0]=sa(b.xUa):a||c.wUa[1]||(c.wUa[1]=sa(b.yUa)))},zUa:function(a){var b,c;a&&(b=this,c=a[0],c&&ta(b.xUa,c),c=a[1],c&&ta(b.yUa,c))}}),e.$n(H,{init:function(){var a=this,b=a.kj;a.yUa=new d(a.getColumnCount(),b,(!1)),a.xUa=new d(a.getRowCount(),b,(!0))},undo:function(a){var b=a.wUa;b&&(this.zUa(b),this.kj.$p())}}),f={init:function(){var a=this;a.rowOutlines=a.ITa.xUa,a.columnOutlines=a.ITa.yUa,a.rowOutlines.groupChangeHandler=function(b){var c,d,e,f=b&&b.indexes;f&&a.recalcRows&&a.recalcRows(f),c=a.parent,c&&a!==c.getActiveSheet()||a.au(),f?(d=f[0],e=f[f.length-1]):(d=0,e=a.getRowCount()-1),u.ao(a,"onGroupChanged",{start:d,end:e,isRow:!0})},a.columnOutlines.groupChangeHandler=function(b){var c,d,e,f=a.parent;f&&a!==f.getActiveSheet()||a.bu(),c=b&&b.indexes,c?(d=c[0],e=c[c.length-1]):(d=0,e=a.getColumnCount()-1),u.ao(a,"onGroupChanged",{start:d,end:e,isRow:!1})},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(){var a=this;r(a.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=Z.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===Q||c===O?b.rowOutlines.UL(b,e):c!==R&&c!==P||b.columnOutlines.UL(b,e))})}},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,i=b.rowOutlines,j=b.columnOutlines,k=this.ITa;"addRows"===c?(k.vUa(!0),ca(i,d,e)):"deleteRows"===c?(k.vUa(!0),da(i,d,e)):"addColumns"===c?(k.vUa(!1),ca(j,f,g)):"deleteColumns"===c?(k.vUa(!1),da(j,f,g)):"invalidateLayout"===c?b.TL=l:"setColumnCount"===c?(k.vUa(!1),3!==h&&1!==h||j.VL(g)):"setRowCount"!==c||3!==h&&2!==h||(k.vUa(!0),i.VL(e))},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=D(f)?f:a.showRowOutline,i=D(g)?g:a.showColumnOutline;E(h)||d.showRowOutline(h),E(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):m,a.columnOutlines=f?f.toJSON(b):m}},i.Worksheet.$n(H,f),g={init:function(){j.SL(this.commandManager())}},i.Workbook.$n(H,g),a.exports=k}()},function(a,b){!function(){"use strict";a.exports={Exp_InvalidIndex:"Invalid index",Exp_InvalidCount:"Invalid count",Exp_InvalidLevel:"Invalid level",Exp_GroupInfoIsNull:"groupInfo is null"}}()}]);