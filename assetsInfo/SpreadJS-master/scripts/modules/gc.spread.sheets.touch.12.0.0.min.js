/*!
 * 
 * Spread.Sheets Library 12.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Touch=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);b.SR={},b.SR.en=c(4),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={},u=c(2),v=c(3),w=u.j.Fa,x=v.Go,y=v.GC$,z=y.extend,A=y.isEmptyObject,B=y.inherit,C=v.Ul,D=C.Nl,E=v.Im,F=v.Rect,G=v.Vl,H=v.En,I=v.kf,J=v.Events,K=v.zp,L=v.yp,M=C.nl,N=C.Ml.mozilla,O=v.Im.Lm,P=C.rl(),Q=P.ipad||P.iphone,R=null,S=void 0,T=Math.abs,U=Math.min,V=Math.max,W=Math.pow,X=Math.atan2,Y=Math.PI,Z=Math.round,$=Math.sqrt,_=Math.atan,aa=Math.log,ba=Math.floor,ca=100,da="touch",ea="none",fa="MSPointerDown",ga="MSPointerMove",ha="MSPointerUp",ia="pointerdown",ja="pointermove",ka="pointerup",la="touchstart",ma="touchmove",na="touchend",oa="MSPOINTER_TYPE_TOUCH",pa=isNaN,qa=parseInt,ra=parseFloat,sa=window,ta=document,ua=sa.Yl,va="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",wa="AAAAAElFTkSuQmCC",xa=v.Bn;function ya(){return u.C(t.SR)()}function za(a){return a.height}function Aa(a){return a.width}function Ba(a){clearInterval(a)}function Ca(){return(new Date).valueOf()}function Da(a,b){var c,d,e,f,g,h,i,j;return!(!a||!b)&&(c=13,d=15,e=c,f=c,g=d,h=d,i=a.X-b.X,j=a.Y-b.Y,T(i)<e&&T(j)<f&&$(i*i+j*j)<U(g,h))}function Ea(a){return a.getActiveSheet()}function Fa(a){return a.getSelections()}function Ga(a){return a.frozenTrailingColumnCount()}function Ha(a){return a.frozenTrailingRowCount()}function Ia(a,b){return a.getColumnCount(b)}function Ja(a,b){return a.getRowCount(b)}b=400,d=1e3,e=20;function Ka(a){var b=y(a).offset(),c=ta.body,d=0,e=0;return b&&(d=b.top+c.clientTop||0,e=b.left+c.clientLeft||0),{FB:d,EB:e}}function La(){var a=this;a.rM=[],a.sM={length:0},a.tM=new Ra,a.uM=new Sa}z(La.prototype,{vM:function(a){this.tM.vM=a},wM:function(a){this.tM.wM=a},xM:function(a){var b=this;b.tM.xM=function(c){if(a){a(c);var d=b.yM;d&&d.zM()}}},AM:function(a){this.tM.AM=a},BM:function(a){this.tM.BM=a},CM:function(a){this.uM.CM=a},DM:function(a){this.uM.DM=a},EM:function(a){this.uM.EM=a},FM:function(a){this.GM=a},HM:function(a){this.IM=a},JM:function(a,b){var c=b?b.KM:this.LM.KM;return C.Z3(a,c)},MM:function(a,b){var c,d,e,f,g,h,i=this,j=b.pointerType,k=b.target,l=b.offsetX,m=b.offsetY;j!==b[oa]&&j!==da||(c=i.JM(k,a),d=c.EB,e=c.FB,f=i.NM(a,k,b.pointerId,new Ta(l+d,m+e),b.timeStamp),f&&M(b),"sheet"===i.LM.OM&&(g=b.pageX-(l+d),h=b.pageY-(m+e),i.LM.KM.canvasOffset={top:h,left:g}))},PM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.aB(f,new Ta(a.offsetX+b.EB,a.offsetY+b.FB),a.timeStamp),c&&M(a)}},QM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.RM(f,new Ta(a.offsetX+b.EB,a.offsetY+b.FB)),c&&M(a)}},SM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[oa]||e===da){if(d.sM[f]===S)return!1;b=d.JM(a.target),c=d.TM(f,new Ta(a.offsetX+b.EB,a.offsetY+b.FB)),c&&M(a)}},UM:function(a,b){var c,d,e,f=Ka(a.KM),g=b.changedTouches,h=!1;for(c=0;c<g.length;c++)d=g[c],e=N?Ca():b.timeStamp,h=this.NM(a,b.target,d.identifier,new Ta(d.pageX-f.EB,d.pageY-f.FB),e)||h;h&&M(b)},VM:function(a){var b,c,d,e=this,f=Ka(e.LM.KM),g=a.changedTouches,h=!1;for(b=0;b<g.length;b++)c=g[b],d=N?Ca():a.timeStamp,h=e.aB(c.identifier,new Ta(c.pageX-f.EB,c.pageY-f.FB),d)||h;h&&M(a)},WM:function(a){var b,c,d=this,e=Ka(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.RM(c.identifier,new Ta(c.pageX-e.EB,c.pageY-e.FB))||g;g&&M(a)},XM:function(a){var b,c,d=this,e=Ka(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.TM(c.identifier,new Ta(c.pageX-e.EB,c.pageY-e.FB))||g;g&&M(a)},YM:function(a){var b,c,d=this,e=d.LM,f=d.ZM;e!==f&&(b=y(e.KM).offset(),c=y(f.KM).offset(),a.X+=b.left-c.left,a.Y+=b.top-c.top)},$M:function(a){var b,c,d,e,f,g=this,h=g.rM;for(g.ZM=R,g.yM=R,c=0;c<h.length;c++)if(h[c]===a){if(d=h[c],e=R,f=R,d._M&&!d._M()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b._M||b._M())){e=b;break}if(e===R)return!1}if(d.bN&&!d.bN()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b.bN||b.bN())){f=b;break}if(f===R)return!1}e===R&&(e=d),f===R&&(f=d),g.LM=d,g.ZM=e,g.cN=f,g.vM(f.dN||R),g.wM(e.eN||R),g.BM(e.fN||R),g.AM(e.gN||R),g.xM(e.hN||R),g.CM(f.iN||R),g.DM(f.jN||R),g.EM(f.kN||R),g.FM(e.GM||R),g.HM(e.IM||R),e.lN&&(g.yM=d.lN);break}return!0},NM:function(a,b,c,d,e){var f=this;return f.sM[c]===S&&(!(0===f.sM.length&&!f.$M(a,b))&&(!!f.ZM&&(f.sM.length>=f.ZM.mN||(!f.yM||!f.yM.nN())&&(f.YM(d),f.yM&&0===f.sM.length&&f.yM.oN(),f.sM[c]={id:c,time:Ca(),position:d},f.sM.length++,f.tM.pN(b,c,d,e),f.tM.qN(c,d,f.sM.length,e),1===f.sM.length&&f.uM.qN(d),1===f.sM.length&&f.GM&&f.GM({rN:d}),!0))))},aB:function(a,b,c){var d=this;return d.sM[a]!==S&&((!d.yM||!d.yM.sN())&&(d.YM(b),d.sM[a]={id:a,time:Ca(),position:b},d.tM.tN(a,b,c),!0))},RM:function(a,b){var c=this;return c.sM[a]!==S&&(delete c.sM[a],c.sM.length--,(!c.yM||!c.yM.uN())&&(c.YM(b),c.tM.vN(a),c.tM.wN(a),0===c.sM.length&&(c.uM.vN(b),c.uM.wN(b)),0===c.sM.length&&c.IM&&c.IM({rN:b}),c.yM&&0===c.sM.length&&0===c.tM._process&&c.yM.zM(),!0))},TM:function(a,b){return this.RM(a,b)},xN:function(a,b){var c,d,e,f,g,h=this,i="."+a.OM,j=".gcSheet",k=fa+j,l=ga+j+i,m=ha+j+i,n="MSPointerCancel"+j+i,o="MSLostPointerCapture"+j+i,p=ia+j,q=ja+j+i,r=ka+j+i,s="LostPointerCapture"+j+i,t="pointercancel"+j+i,v=la+j,x=ma+j,z=na+j,A="touchcancel"+j;function B(){y(ta).bind(l,F).bind(m,G).bind(q,F).bind(r,G).bind(n,H).bind(o,H).bind(s,H).bind(t,H)}function D(){y(ta).unbind(l).unbind(q).unbind(m).unbind(r).unbind(n).unbind(t).unbind(o).unbind(s)}function E(b){B(),h.MM(a,b)}function F(a){h.PM(a)}function G(a){h.QM(a),0===h.sM.length&&D()}function H(a){h.SM(a),0===h.sM.length&&D()}c=a.KM,d=h.rM,e=u.k.Cb(d,a),e>=0&&b||e<0&&!b||(f=C._Va(),b?f?(g=c.style,w(g.msTouchAction)||(g.msTouchAction=ea),w(g.touchAction)||(g.touchAction=ea),y(c).bind(k,E).bind(p,E)):(y(c).bind(v,function(b){h.UM(a,b)}),y(c).bind(x,function(a){h.VM(a)}).bind(z,function(a){h.WM(a)}).bind(A,function(a){h.XM(a)})):f?y(c).unbind(k).unbind(p):y(c).unbind(v).unbind(x).unbind(z).unbind(A),b?d.push(a):d.splice(e,1))},no:function(){var a,b=this,c=b.rM;for(a=c.length-1;a>=0;a--)b.xN(c[a],!1)}});function Ma(a,b){var c=X(b.Y,b.X)-X(a.Y,a.X);return c>Y?c-=2*Y:c<-Y&&(c+=2*Y),c}function Na(a,b){return $((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))}function Oa(a,b,c){var d=new Ta(c._Center.X,c._Center.Y),e=new Ta(b.X-d.X,b.Y-d.Y),f=new Ta(a.X-d.X,a.Y-d.Y),g=U(1,W(Na(b,d)/c._Radius,4)),h=Ma(e,f);return pa(h)?0:h*g}function Pa(a){return T(a)<=2.220446049250313e-16}function Qa(a,b){var c=!1,d=!1,e;return 0!==a&&(e=_(b/a)/Y*180,e<20&&(c=!0)),0===a?d=!0:(e=_(b/a)/Y*180,e>75&&e<105&&(d=!0)),{yN:c,zN:d}}function Ra(){var a=this;a.AN=0,a.BN=0,a.CN=1,a.DN=0,a.EN=0,a._process=0,a.FN=511,a.GN=new _a,a.HN=20,a.IN=new Va}z(Ra.prototype,{pN:function(a,b,c,d){var e,f=this;3===f._process&&f.JN(!0),f.KN=2===f._process&&1===f.GN.MN(),f.NN=a,e={},e.Np=b,e.ON=c,e.PN=c,f.GN.QN(e),f.RN=d,f.GN.MN()>1&&(f.SN=!1,f.TN=!1,1===f._process&&f.UN())},qN:function(a,b,c){0===this._process&&1===c&&this.VN(this.GN.WN(0).PN)},tN:function(a,b,c){var d,f,g,h,i,j,k,l=this;if(0!==l.FN&&l.GN.XN(a)){if(1===l._process&&1===l.GN.MN()){if(d=l.YN(),!l.ZN(1)&&!l.ZN(2)&&!d)return;if(f=l.GN.$N(a).PN,Da(b,f))return;g=T(b.X-f.X),h=T(b.Y-f.Y),l._N(g,h)}if(!(c-l.RN<e)){if(l.GN.$N(a).aO=b,i=l.GN.MN(),i>1)for(j=0;j<i;j++)if(k=l.GN.WN(j),!k.aO)return;for(l.bO(c),l.RN=c,i=l.GN.MN(),j=0;j<i;j++)k=l.GN.WN(j),k.ON=k.aO,k.aO=R}}},wN:function(){var a=this;a.cO&&(a.dO(a.cO),a.cO=R)},vN:function(a){var b=this;b.GN.XN(a)&&(b.GN.eO(a),2===b._process?0===b.GN.MN()&&(b.ZN(64)||b.ZN(256)||b.ZN(128)?b.fO():b.JN(!0)):2===b._process||3===b._process?b.JN(!0):1===b._process&&b.JN(!1))},bO:function(a){var b,c,d,e,f,g=this,h=g.gO(),i=h.hO,j=h.iO,k=h.SH,l=g.jO(),m=l.kO,n=l.eb,o=l.lO;if(g.AN+=i,g.BN+=j,g.CN*=n,g.DN+=m,g.EN+=o,b={},b.lO=o,b.kO=m,b.mO=a-g.RN,b.hO=i,b.iO=j,g.IN.nO(b),g.oO=k,1===g._process||2===g._process){if(1===g._process&&(c=g.UN()))return;if(d=new $a,d.pO=o,d.qO=m,d.rO=n,d.sO=new Ta(i,j),e=new Wa(g.IN),f=new cb(g.NN,g.tO(),d,(!1),k,e),g.uO(f),f.vO)return void g.JN(!0)}},UN:function(){var a,b=this;return b._process=2,a=new eb(b.NN,b.GN.MN(),b.tO(),b.GN.WN(0).PN),b.wO(a),!!a.vO&&(b.JN(!0),!0)},_N:function(a,b){var c=Qa(a,b);this.SN=c.yN,this.TN=c.zN},gO:function(){var a=0,b=0,c=this.xO(),d=c.yO,e=c.zO,f=new Ta(d.X,d.Y);return a=d.X-e.X,b=d.Y-e.Y,{hO:a,iO:b,SH:f}},jO:function(){var a,b=this,c=0,d=1,e=0;return b.ZN(16)&&1===b.GN.MN()&&b.YN()&&(c=Oa(b.GN.WN(0).aO,b.GN.WN(0).ON,b.AO)),b.GN.MN()>1&&(a=b.BO(),c=a.kO,d=a.eb,e=a.lO),c=c/Y*180,{kO:c,eb:d,lO:e}},BO:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.xO(),n=m.yO,o=m.zO,p=l.YN(),q=p?l.AO._Center:new Ta(0,0),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=l.GN.MN();for(a=0;a<y;a++)b=l.GN.WN(a),c=b.aO,d=b.ON,e=Na(c,n),f=Na(d,o),g=p?new Ta(d.X-q.X,d.Y-q.Y):new Ta(d.X-o.X,d.Y-o.Y),h=p?new Ta(c.X-q.X,c.Y-q.Y):new Ta(c.X-n.X,c.Y-n.Y),i=Na(d,q),j=Na(c,q),f>=l.HN&&e>=l.HN&&(v++,w+=e,x+=f,(!p||i>=l.HN)&&j>=l.HN&&(k=Ma(g,h),r+=k,u++));return u>0&&l.ZN(16)?r/=u:r=0,v>0&&l.ZN(32)?(l.KN||(s=w/x),t=(w-x)/v,l.CO=w/v):l.CO=0,{kO:r,eb:s,lO:t}},ZN:function(a){return 0!==(this.FN&a)},xO:function(){var a,b,c,d,e,f,g=0,h=0,i=0,j=0,k=this.GN,l=k.MN();for(a=0;a<l;a++)b=k.WN(a),c=b.ON,d=b.aO,g+=c.X,h+=c.Y,i+=d.X,j+=d.Y;return e=new Ta(g/l,h/l),f=new Ta(i/l,j/l),{yO:f,zO:e}},YN:function(){var a=this.AO;return a&&!pa(a._Radius)},VN:function(a){var b=this,c=new fb(b.NN,b.FN,R,a);return c.DO=511,b.EO(c),b.FO=c.DO,0===c.DO?(b.JN(!1),!1):(b.FN=c.DO,b.AO=c.GO,b._process=1,!0)},JN:function(a){var b,c=this,d=3===c._process;c._process=0,c.HO&&(Ba(c.HO),c.HO=R),a&&(b=new bb(c.NN,c.tO(),d,Ua(c.oO),new Wa(c.IN)),3===c._process?c.cO=b:c.dO(b)),c.IN.IO(),c.GN.IO(),c.AO=R,c.AN=0,c.BN=0,c.CN=1,c.DN=0,c.EN=0,c.SN=!1,c.TN=!1,c.FN=0},fO:function(){var a,b,c=this,d={},e=new Wa(c.IN);return d.JO=c.ZN(64)?e.KO().X:0,d.LO=c.ZN(64)?e.KO().Y:0,d.MO=c.ZN(256)?e.pO():0,d.NO=c.ZN(128)?e.OO():0,0===d.JO&&0===d.LO&&0===d.MO&&0===d.NO?void c.JN(!0):(d.PO=new Za(d.JO,d.LO),d.QO=new Xa(d.MO),d.RO=new Ya(d.NO),e=new Wa(R,d.JO,d.LO,d.NO,d.MO),a=new db(c.NN,c.tO(),new $a,e,d.QO,d.RO,d.PO),c.SO(a),d.PO=a.TO,d.QO=a.QO,d.RO=a.RO,d.PO.UO<=0&&d.PO.VO<=0&&d.PO.WO(.003),d.QO.XO()<=0&&d.QO.WO(.002),d.RO.XO()<=0&&d.RO.WO(.003),b=Ca(),d.YO=b,d.ZO=b,d.$O=0,d._O=0,c._process=3,void(c.HO=setInterval(function(){try{c.aP(d)}catch(a){}},20)))},aP:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=Ca(),q=p-a.ZO;if(0!==q){if(b=a.JO,c=a.LO,d=a.MO,e=a.NO,a.JO=o.bP(q,a.PO.UO,a.JO),a.LO=o.bP(q,a.PO.VO,a.LO),a.MO=o.bP(q,a.QO.XO(),a.MO),a.NO=o.bP(q,a.RO.XO(),a.NO),b=(b+a.JO)/2,c=(c+a.LO)/2,d=(d+a.MO)/2,e=(e+a.NO)/2,a.ZO=p,f=!1,Pa(b)&&Pa(c)&&Pa(d)&&Pa(e)&&(f=!0),g=q*b,h=q*c,i=q*d,j=q*e,k=1,o.CO>0&&(o.CO+2*i<0&&(i=-o.CO/2+1),0!==o.CO&&(k=(o.CO+2*i)/o.CO)),o.EN+=i,o.DN+=j,o.AN+=g,o.BN+=h,o.CN*=k,o.CO+=i,o.oO=new Ta(o.oO.X+g,o.oO.Y+h),a.$O+=g,a._O+=h,f){if(g=Z(a.$O),h=Z(a._O),Pa(g)&&Pa(h))return void o.JN(!0)}else T(a.$O)>=1&&(g=a.$O,a.$O-=g),T(a._O)>=1&&(h=a._O,a._O-=h);return l=new $a,l.sO=new Ta(g,h),l.rO=k,l.pO=i,l.qO=j,m=new Wa(R,a.JO,a.LO,a.NO,a.MO),n=new cb(o.NN,o.tO(),l,(!0),Ua(o.oO),m),o.uO(n),n.vO?void o.JN(!0):void(f&&o.JN(!0))}},bP:function(a,b,c){if(Pa(c))return 0;var d;return d=c<0?c+b*a:c-b*a,(d<0&&c>0||d>0&&c<0)&&(d=0),d},tO:function(){var a=this,b=new $a;return b.pO=a.EN,b.qO=a.DN,b.rO=a.CN,b.sO=new Ta(a.AN,a.BN),b},cP:function(a,b,c,d){var e,f=this,g=new $a,h=new $a,i=0,j=0,k=0,l=0,m=f.ZN(4)&&f.SN,n=f.ZN(8)&&f.TN;return!f.ZN(1)||n||a&&!f.ZN(64)||(g.sO.X=b.sO.X,h.sO.X=c.sO.X,i=d.KO().X),!f.ZN(2)||m||a&&!f.ZN(64)||(g.sO.Y=b.sO.Y,h.sO.Y=c.sO.Y,j=d.KO().Y),!f.ZN(32)||a&&!f.ZN(256)?(g.rO=b.rO,h.rO=1):(g.rO=b.rO,g.pO=b.pO,h.rO=c.rO,h.pO=c.pO,l=d.pO()),!f.ZN(16)||a&&!f.ZN(128)||(g.qO=b.qO,h.qO=c.qO,k=d.OO()),e=new Wa(R,i,j,k,l),new ab(g,h,e)},EO:function(a){this.vM&&a&&this.vM(a)},wO:function(a){this.wM&&a&&this.wM(a)},dO:function(a){var b,c=this;c.xM&&a&&(b=c.cP(!1,a.dP,a.dP,a.eP),a.dP=b.dP,a.eP=b.eP,c.xM(a))},SO:function(a){var b,c=this;c.AM&&a&&(b=c.cP(!1,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.AM(a))},uO:function(a){var b,c=this;c.BM&&a&&(b=c.cP(a.gP,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.BM(a))}});function Sa(){}z(Sa.prototype,{qN:function(a){var c,d=this;d._pointerCount++,d._pointerCount>1||(c=Ca(),d.hP&&Da(a,d.hP)&&c-d.iP<b?d.Jb++:(d.hP=a,d.Jb=1),d.jP=a,d.iP=c)},wN:function(){var a=this;a.cO&&(a.cO instanceof gb?a.kP(a.cO):a.cO instanceof hb&&a.lP(a.cO),a.cO=R)},vN:function(a){var b,c=this;c._pointerCount--,c._pointerCount>0||(b=Ca(),Da(a,c.jP)?b-c.iP>d?c.cO=new hb(c.jP):c.Jb>1?(c.Jb=0,c.mP(new ib(c.hP)),c.hP=R):c.cO=new gb(c.jP):c.hP=R)},nP:function(){this.hP=R},kP:function(a){this.CM&&a&&this.CM(a)},mP:function(a){this.DM&&a&&this.DM(a)},lP:function(a){this.EM&&a&&this.EM(a)}});function Ta(a,b){this.X=a,this.Y=b}function Ua(a){return new Ta(a?Z(a.X):-1,a?Z(a.Y):-1)}t.oP=Ta;function Va(){var a=this;a.Jb=0,a.oI=0,a.pP=10,a.qP=[]}z(Va.prototype,{rP:function(a){var b,c,d,e,f,g,h=this;if(0===h.Jb)return 0;for(b=0,c=(1+h.Jb)*h.Jb/2,d=h.Jb-1;d>=0;d--)e=0,f=h.sP(d),0===a?e=f.hO:1===a?e=f.iO:2===a?e=f.lO:3===a&&(e=f.kO),g=h.tP(e,f.mO),g*=d+1,b+=g;return b/c},tP:function(a,b){return a/b},sP:function(a){return this.qP[this.uP(a)]},vP:function(){return this.qP[this.Jb-1]},nO:function(a){var b,c,d=this;for(10===d.Jb&&d.wP(),d.Jb++,d.qP[d.uP(d.Jb-1)]=a,b=e*d.pP,c=0;c<d.Jb;c++)a.mO-d.qP[c].mO>b&&(d.wP(),c--)},wP:function(){var a=this;a.oI++,a.oI===a.pP&&(a.oI=0),a.Jb--},IO:function(){this.Jb=0},uP:function(a){return(this.oI+a)%this.pP}});function Wa(a,b,c,d,e){var f=this;a?f.qP=a:(f.xP=new Ta(b,c),f.yP=d,f.lO=e)}z(Wa.prototype,{KO:function(){var a=this;return a.xP||(a.xP=new Ta(a.qP.rP(0),a.qP.rP(1))),a.xP},OO:function(){var a=this;return w(a.yP)&&(a.yP=a.qP.rP(3)),a.yP},pO:function(){var a=this;return w(a.lO)&&(a.lO=a.qP.rP(2)),a.lO}});function Xa(a){this.zP=a,this.AP=0}z(Xa.prototype,{XO:function(){var a=this,b=a._DesiredExpansion,c=a._DesiredDeceleration,d=a.zP;return pa(b)||0===b?pa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function Ya(a){this.zP=a,this.AP=0}z(Ya.prototype,{XO:function(){var a=this,b=a._DesiredRotation,c=a._DesiredDeceleration,d=a.zP;return pa(b)||0===b?pa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function Za(a,b){var c=this;c.BP=a,c.CP=b,c.UO=0,c.VO=0,c.AP=0,c.DP=$(a*a+b*b)}z(Za.prototype,{EP:function(){var a=this,b=a._DesiredDisplacement,c=a.DP,d=a.BP,e=a.CP,f=a.XO();pa(b)||0===b?pa(f)||0===f?(a.UO=0,a.VO=0):(a.UO=f*T(d)/c,a.VO=f*T(e)/c):(a.UO=.5*c*T(d)/b,a.VO=.5*c*T(e)/b)},XO:function(){var a=this,b=a._DesiredDeceleration;return pa(b)&&pa(a._DesiredDisplacement)?a.AP:b},WO:function(a){this.AP=a,this.EP()}});function $a(){var a=this;a.sO=new Ta(0,0),a.rO=0,a.qO=0,a.pO=0}function _a(){this.FP=[]}z(_a.prototype,{XN:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return!0;return!1},QN:function(a){this.FP.push(a)},eO:function(a){var b,c=this.FP;for(b=0;b<c.length;b++)if(c[b].Np===a){c.splice(b,1);break}},MN:function(){return this.FP.length},WN:function(a){return this.FP[a]},$N:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return c;return R},IO:function(){var a=this.FP;a.splice(0,a.length)}});function ab(a,b,c){var d=this;d.dP=a,d.fP=b,d.eP=c}function bb(a,b,c,d,e){var f=this;f.GP=a,f.dP=b,f.gP=c,f.rN=d,f.eP=e}function cb(a,b,c,d,e,f){var g=this;g.GP=a,g.dP=b,g.fP=c,g.gP=d,g.rN=e,g.eP=f}function db(a,b,c,d,e,f,g){var h=this;h.GP=a,h.dP=b,h.fP=c,h.eP=d,h.QO=e,h.RO=f,h.TO=g}function eb(a,b,c,d){var e=this;e.GP=a,e.HP=b,e.dP=c,e.rN=d}function fb(a,b,c,d){var e=this;e.GP=a,e.DO=b,e.GO=c,e.rN=d}function gb(a){this.rN=a}function hb(a){this.rN=a}function ib(a){this.rN=a}function jb(a,b){var c=a*b;return c>4?c=4:c<.5&&(c=.5),c}function kb(a){this.kj=a}z(kb.prototype,{IP:function(a,b){var c=this.Xs;return c?a===H.Nn(c)&&b===H.On(c)||H.Pn(c,a,b):(c=D("canvas"),H.Kn(c,R,this.kj),H.Pn(c,a,b)),c},JP:function(a,b,c,d){var e=this,f=H.Nn(a),g=H.On(a),h=e.IP(f,g),i=h.getContext("2d"),j=H.Ln(h),k=H.Mn(h);xa.Cn(i,1,1),i.drawImage(a,0,0,Aa(h),za(h),0,0,Aa(h),za(h)),xa.Cn(i,j,k),e.Xs=h,e.KP=b,e.LP=c,e.MP=d},NP:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=H.Nn(a),q=H.On(a),r=Ga(o),s=Ha(o),t=r>0?1:0,u=s>0?1:0,v=n.LP,w=ub(o),x=n.KP,y=o.am(),z=b/n.MP,A=a.getContext("2d"),B=H.Ln(a),C=H.Mn(a),D=n.Xs;A.save(),A.fillStyle=c,A.fillRect(0,0,p,q),l=o.rowOutlines,m=o.columnOutlines,l&&l.jp(o,A,R,!0),m&&m.jp(o,A,R,!1),d=v.x+Aa(v),e=v.y+za(v),f=x.lt-d-t,g=x.ot-e-u,h=w.x+Aa(w),i=w.y+za(w),j=f*z,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,xa.Cn(A,1,1),A.drawImage(D,d,e,f,g,h,i,j,k),r>0&&(d=x.lt-t,e=v.y+za(v),f=x.js+t,g=x.ot-e-u,h=y.lt-t,i=w.y+za(w),j=y.js+t,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),s>0&&(d=v.x+Aa(v),e=x.ot-u,f=x.lt-d-t,g=x.gs+u,h=w.x+Aa(w),i=y.ot-u,j=f*z,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),r>0&&s>0&&(d=x.lt-t,e=x.ot-u,f=x.js+t,g=x.gs+u,h=y.lt-t,i=y.ot-u,j=y.js+t,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),xa.Cn(A,B,C),A.restore()},OP:function(){var a=this,b=a.kj,c=b.zoom(),d=b.yl.vI();d&&a.JP(d.canvas,b.am(),ub(b),c)},PP:function(a){var b,c,d,e=this,f=e.kj;f.endEdit()&&(b=jb(a,e.MP),f.zoom()!==b&&(f.Wq(J.UserZooming,{sheet:f,sheetName:f.name(),oldZoomFactor:f.zoom(),newZoomFactor:b}),f.XSa(b),f.invalidateLayout(),c=f.yl,d=c.bm(),d&&e.NP(d.canvas,b,c.zI(!1)),f.QP&&f.QP(R,b),f.RP&&f.RP(R)))},SP:function(a){var b=this,c=b.kj;c.XSa(jb(a,b.MP)),c.oq=!0,c.jq=!0,c.$p()}}),t.TP=kb,f=200,g=20;function lb(a,b,c){var d=c,e=0,f=0,g=a.ss,h,i,j=a.am().qt,k=a.jt(1).findRow(d);if(k)if(b>0){for(h=a.Rt(-1),e=j-k.y;d>h&&e<b;)d--,e+=g.Sl(d);f=b-e}else if(b<0){for(i=a.ns(),e=-(k.y+za(k)-j);d<i&&e>b;)d++,e-=g.Sl(d);f=b-e}return{cj:d,UP:f}}function mb(a,b,c){var d=c,e=0,f=0,g,h,i=a.ss,j=a.am().pt,k=a.it(1).findCol(d);if(k)if(b>0){for(g=a.Ot(-1),e=j-k.x;d>g&&e<b;)d--,e+=i._m(d);f=b-e}else if(b<0){for(h=a.ps(),e=-(k.x+Aa(k)-j);d<h&&e>b;)d++,e-=i._m(d);f=b-e}return{dj:d,UP:f}}function nb(a,b){return qa(-b/(a/b+1)+b)}function ob(a,b){return qa(b*(-b/(a-b)-1))}function pb(a,b,c,d,e,f){a.fillStyle=b,a.fillRect(c,d,e,f)}function qb(a,b,c,d,e){var f,g,h,i,j,k=E.Km(0,"gc-columnHeader-normal"),l=k&&k.backgroundImage,m=k&&k.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(g=C.wl(l),f=a.createLinearGradient(b+d/2,c,b+d/2,c+e),h=0,i=g.length;h<i;h++)j=g[h],f.addColorStop(j.point,j.color);else m&&(f=m);return f}function rb(){var a=E.Km(0,"gc-rowHeader-normal");return a&&a.backgroundColor}function sb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=a.yl,r=a.options,s=r.sheetAreaOffset,t=s.left,u=s.top,v=q.zI(!1),w=q.bm(),x=q.vI(),y=a.jt(1),z=ub(a),A=p.zr,B=t>=1?1:0,C=u>=1?1:0,D=Aa(p),E=a.Rt(-1),F=y.findRow(E);F&&(c=p.qt,d=F.y-c-1-C,d>0&&(b?(e=p.Br,f=rb(),pb(w,f,A,c,e-1,d+1),pb(x,f,A,c,e-1,d+1),pb(w,v,A+e,c,D-e-z.width,d),pb(x,v,A+e,c,D-e-z.width,d)):(pb(w,v,A,c,D,d),pb(x,v,A,c,D,d)))),g=a.Rt(Ja(a),!0),h=y.findRow(g),h&&(c=h.y+za(h),d=p.ot-c-1-C,d>0&&(pb(w,v,A,c,D,d),pb(x,v,A,c,D,d))),i=a.it(1),c=p.Ar,d=za(p),j=a.Ot(-1),k=i.findCol(j),k&&(A=p.pt,D=k.x-A-1-B,D>0&&(b?(l=p.Cr,m=qb(w,A,c,D+1,l-1),pb(w,m,A,c,D+1,l-1),pb(x,m,A,c,D+1,l-1),pb(w,v,A,c+l,D,d-l-z.height),pb(x,v,A,c+l,D,d-l-z.height)):(pb(w,v,A,c,D,d),pb(x,v,A,c,D,d)))),n=a.Ot(Ia(a),!0),o=i.findCol(n),o&&(A=o.x+Aa(o),D=p.lt-A-1-B,D>0&&(pb(w,v,A,c,D,d),pb(x,v,A,c,D,d)))}function tb(a,b,c,d,e,f){a.beginPath(),a.strokeStyle=b,a.moveTo(c,d),a.lineTo(e,f),a.stroke()}function ub(a){var b=a.options,c=b.sheetAreaOffset;return a.Gt&&a.Gt()||{x:c.left,y:c.top,width:0,height:0}}function vb(a,b){var c,d,e,f,g,h,i,j=a.am(),k=a.yl,l=k.bm(),m=a.jt(1),n=ub(a),o=a.Rt(-1),p=m.findRow(o),q=O("gc-group").color;p&&(c=j.qt,d=p.y-c,d>0&&b&&n.width>0&&0===j.Br&&tb(l,q,j.kt-.5,c,j.kt-.5,p.y)),e=a.it(1),f=a.Ot(-1),g=e.findCol(f),g&&(h=j.pt,i=g.x-h,i>0&&b&&n.height>0&&0===j.Cr&&tb(l,q,h,j.nt-.5,g.x,j.nt-.5))}function wb(a,b){var c,d,e,f,g,h=a.am(),i=a.yl,j=a.options.gridline.color,k=E.Km(0,"gc-columnHeader-normal"),l=k&&k.borderBottomColor,m=i.bm(),n=a.jt(1),o=ub(a),p=h.zr,q=Aa(h),r=a.Rt(-1),s=n.findRow(r);s&&(c=h.qt,d=s.y-c,d>0&&(tb(m,j,p,s.y-.5,p+q-o.width,s.y-.5),b&&(0===o.width&&tb(m,j,h.zr-.5,c,h.zr-.5,s.y),tb(m,l,h.kt-.5,c,h.kt-.5,s.y)))),e=a.it(1),c=h.Ar,d=za(h),f=a.Ot(-1),g=e.findCol(f),g&&(p=h.pt,q=g.x-p,q>0&&(tb(m,j,g.x-.5,c,g.x-.5,c+d-o.height),b&&(0===o.height&&tb(m,j,p,h.Ar-.5,g.x,h.Ar-.5),tb(m,l,p,h.nt-.5,g.x,h.nt-.5))))}function xb(a,b){var c=0;return a||(c|=1),b||(c|=2),c}function yb(a){this.kj=a}function zb(a,b){for(var c,d=new L,e=a.ss,f=a.am(),g=V(a.frozenColumnCount(),a.qq),h=Ia(a)-Ga(a),i=f.pt+b,j=f.er-b;j>0&&g<h;g++)c=e._m(g),d.push(new K((-1),g,i,(-1),c,(-1))),i+=c,j-=c;return d}function Ab(a,b){for(var c,d=new L,e=a.ss,f=a.am(),g=V(a.frozenRowCount(),a.lq),h=Ja(a)-Ha(a),i=f.qt+b,j=f.jr-b;j>0&&g<h;g++)c=e.Sl(g),d.push(new K(g,(-1),(-1),i,(-1),c)),i+=c,j-=c;return d}function Bb(a,b){var c=0;return c|=0!==a?1:0,c|=0!==b?2:0}z(yb.prototype,{VP:function(a){var b=this.kj,c=b.bs;c.viewport||(c.viewport={}),c.viewport[1]=zb(b,a),b.nmb=a},WP:function(a){var b=this.kj,c=b.as;c.viewport||(c.viewport={}),c.viewport[1]=Ab(b,a),b.omb=a},XP:function(){var a=this.kj,b=a.bs.viewport,c=a.as.viewport;a.invalidateLayout(),a.bs.viewport=b,a.as.viewport=c},ju:function(a,b,c,d){var e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.kj,y=x.options,z=x.lq,A=lb(x,a,z),B=A.cj,C=A.UP;if(x.lq=B,x.Xq>0)return!1;if(e=x.Dr(),h=x.am(),i=h.qt,j=h.jr,k=e?e.x:h.x,l=Aa(h),p=y.sheetAreaOffset,l+=p.left,a<0)w.YP=0,w.ZP=0,s=x.jt(1),s&&s.length>0&&(q=s.findRow(B)),q&&(r=s[s.length-1],r.row>=B&&(m=2+p.top,n=i+T(a),o=U(i+j,r.y+za(r))-n,o>=0&&(o-=m,w.WP(C-za(q)),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=i,d.x=k,d.y=i+o,d.width=l,d.height=j-o)));else if(a>0){if(t=x.Rt(-1),B===t&&C>0)if(w.YP>0&&w.ZP>0){if(u=w.YP+a,v=nb(u,f),a=v-w.ZP,C=v,a<=0)return b;if(b&&v>=g)return!0;w.YP=u,w.ZP=v}else{if(C>=f&&(a-=C-(f-1),C=f-1,a<=0))return b;if(u=ob(C,f),v=C,b&&v>=g)return!0;w.YP=u,w.ZP=v}else w.YP=0,w.ZP=0;a<j&&(m=2+p.top,n=i,o=j-a,Ha(x)>0&&(o-=1),w.WP(C),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=n+a,d.x=k,d.y=n,d.width=l,d.height=a+m)}return!1},lu:function(a,b,c,d){var e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.kj,y=x.qq,z=mb(x,a,y),A=z.dj,B=z.UP;if(x.qq=A,x.Xq>0)return!1;if(e=x.Dr(),h=x.am(),i=h.pt,j=h.er,k=e?e.y:h.y,l=za(h),r=x.options.sheetAreaOffset,l+=r.top,a<0)w.$P=0,w._P=0,u=x.it(1),u&&u.length>0&&(s=u.findCol(A)),s&&(t=u[u.length-1],t.col>=A&&(m=2+r.left,n=i+T(a),o=U(i+j,t.x+Aa(t))-n,o>=0&&(o-=m,w.VP(B-Aa(s)),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=i,c.ty=k,d.x=i+o,d.y=k,d.width=j-o,d.height=l)));else if(a>0){if(v=x.Ot(-1),A===v&&B>0)if(w.$P>0&&w._P>0){if(p=w.$P+a,q=nb(p,f),a=q-w._P,B=q,a<=0)return b;if(b&&q>=g)return!0;w.$P=p,w._P=q}else{if(B>=f&&(a-=B-(f-1),B=f-1,a<=0))return b;if(p=ob(B,f),q=B,b&&q>=g)return!0;w.$P=p,w._P=q}else w.$P=0,w._P=0;a<j&&(m=2+r.left,n=i,o=j-a,Ga(x)>0&&(o-=1),w.VP(B),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=n+a,c.ty=k,d.x=n,d.y=k,d.width=a+m,d.height=l)}return!1},aQ:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.kj,z=!0,A=!0,B=y.yl,C=B.bm(),D=0!==(2&c),E=0!==(1&c);if(E||D)return i=y.Dr(),j=y.am(),k=i?i.y:j.y,l=za(j),m=i?i.x:j.x,n=Aa(j),D&&(f={},e={},z=x.ju(b,d,e,f),B.Ow(e.x,e.y,Aa(e),za(e),e.tx,e.ty)),E&&(g={},h={},A=x.lu(a,d,g,h),B.Ow(g.x,g.y,Aa(g),za(g),g.tx,g.ty),D||(f=h)),o=y.parent,o&&!o.options.scrollbarShowMax&&(E&&(y.oq=!0),D&&(y.jq=!0)),x.XP(),p=y.rowOutlines&&!y.rowOutlines.iT()?1:0,q=y.columnOutlines&&!y.columnOutlines.iT()?1:0,E&&D?B._l(C,new F(f.x,f.y,Aa(f),za(f)+p),new F(h.x,h.y,Aa(h)+q,za(h))):B._l(C,new F(f.x,f.y,Aa(f)+q,za(f)+p)),r=new F(m,k,n,l),s=y.getSelections(),s&&s.length>0&&(t=y.getRangeRect(1,1,s[0]),u=V(r.x+r.width,t.x+t.width),v=V(r.y+r.height,t.y+t.height),r.x=U(r.x,t.x),r.y=U(r.y,t.y),r.width=u-r.x+1,r.height=v-r.y+1),B.Pw(C,r),wb(y,!0),sb(y,!0),x.bQ(E,D),vb(y,!0),w=y.options.sheetAreaOffset,y.options.rowHeaderVisible||B.B0a(C,new F(m,k,2,l+w.top)),y.options.colHeaderVisible||B.B0a(C,new F(m,k,n+w.left,2)),z&&A},bQ:function(a,b){var c,d=this.kj;b&&d.os(),a&&d.qs(),d.mm.Qw(),c=d.ITa.Ky,c&&c.cQ()},dQ:function(a,b,c){function d(a,b,c,d){return a/=c,W(.75,a)*d*(b?1:-1)}function e(a,b,c){return a=T(a),a/=c,aa(a)/aa(.75)*b}var g=this,h=g.kj,i=f,j=10,k=20,l=100,m=e(a,j,i),n=e(b,j,i),o=a,p=b,q=0,r=0,s=!1,t=!1;g.jI=setInterval(function(){var e,f,u,v,w;return s&&t?(h.ss.jn(),e=h.parent,e&&!e.options.scrollbarShowMax&&(h.oq=!0,h.jq=!0),h.ss.kn(),h.omb=0,h.nmb=0,h.$p(),h.qs(),h.os(),Ba(g.jI),void(g.jI=R)):(m+=k,n+=k,void(m>l&&n>l?(g.aQ(a-q,b-r,xb(s,t),c),s=!0,t=!0):(m>l&&!s&&(g.aQ(a-q,0,1,c),s=!0),n>l&&!t&&(g.aQ(0,b-r,2,c),t=!0),f=d(m,a>0,j,i),u=d(n,b>0,j,i),v=ba(o-f),w=ba(p-u),g.aQ(v,w,xb(s,t),c),o=f,p=u,q+=v,r+=w)))},k)},qG:function(a){var b=this,c=b.kj,d=c.ss;b.jI&&(d.kn(),Ba(b.jI),b.jI=R),b.$P=0,b._P=0,b.YP=0,b.ZP=0,b.eQ=c.lq,b.fQ=c.qq,a&&d.hn()},NG:function(a,b){var c=qa(a.X),d=qa(a.Y),e=Bb(c,d);return this.aQ(c,d,e,b)},gQ:function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kj,l=k.am(),m=l.pt,n=l.qt,o=k.lq,p=k.qq,q=k.it(1),r=k.ps();q&&q.length>0&&(b=q.findCol(p),p<r&&b&&b.x+Aa(b)-m<Aa(b)/2&&p++),c=k.jt(1),e=k.ns(),c&&c.length>0&&(d=c.findRow(o),o<e&&d&&d.y+za(d)-n<za(d)/2&&o++),f=0,g=0,q&&q.length>0&&(b=q.findCol(p),f=m-b.x),c&&c.length>0&&(d=c.findRow(o),g=n-d.y),h=j.eQ,o!==h&&k.mq(o),i=j.fQ,p!==i&&k.rq(p),j.dQ(f,g,a)}});function Cb(a,b,c,d,e){var f,g,h,i,j,k=a.parent,l=a.mm,m=a.options,n=b.rowViewportIndex,o=b.colViewportIndex,p=Fa(a),q=R;return a.CH&&p.length>0&&(f=p[p.length-1],g=f.row,h=f.row+f.rowCount-1,i=f.col,j=f.col+f.colCount-1,k&&!k.options.allowUserResize||(g!==-1&&i===-1&&n>=0&&o<0&&m.rowHeaderVisible?(q=l.mH(a,b,e,2,d),!q||"sizeRow"!==q.action&&"sizeHiddenRow"!==q.action||2!==q.sheetArea||q.index===h||(q=R)):g===-1&&i!==-1&&n<0&&o>=0&&m.colHeaderVisible&&(q=l.oH(a,b,e,1,c),!q||"sizeCol"!==q.action&&"sizeHiddenCol"!==q.action||1!==q.sheetArea||q.index===j||(q=R)))),q}function Db(a,b,c,d){var e,f,g,h,i,j,k,l,m;if(0===a.selectionPolicy())return R;for(e=b.hitTestType,f=Yb(a),g=Fa(a),h=3,a.CH&&g.length>0&&(i=g[g.length-1],i.row!==-1&&i.col!==-1?h=3:i.row!==-1?h=2:i.col!==-1&&(h=1)),j=0;j<f.length;j++)if(k=f[j],k&&(k.x-=Aa(k),k.y-=za(k),k.width*=3,k.height*=3,k.contains(c,d)))return w(b.row)&&(l=a.jt(1),l&&l.length>0&&(b.row=l[l.length-1].row)),w(b.col)&&(m=a.it(1),m&&m.length>0&&(b.col=m[m.length-1].col)),{x:c,y:d,type:h,isHeader:!1,isFirstIndicator:0===j};return 1===e?{x:c,y:d,type:1,isHeader:!0}:2===e?{x:c,y:d,type:2,isHeader:!0}:R}function Eb(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=R,r=b.rowViewportIndex,s=b.colViewportIndex;if(w(r)||w(s))return q;if(e=a.parent,f=a.Ix(),r>=0&&s>=0&&1===a.ITa.getSelections().length){if(g=a.Tq(f),h=Ga(a),i=Ha(a),j=Ia(a)-h,k=Ja(a)-i,1===s&&h>0&&g.col<j&&g.col+g.colCount>j&&(l=a.Hr(s),l&&l.length>0&&(m=l[l.length-1],c>m.x+Aa(m))))return q;if(1===r&&i>0&&g.row<k&&g.row+g.rowCount>k&&(n=a.Gr(r),n&&n.length>0&&(o=n[n.length-1],d>o.y+za(o))))return q}return p=Vb(a),p&&(q||(p.x-=Aa(p),p.y-=za(p),p.width*=3,p.height*=3,p.contains(c,d)&&(q={action:"drag",side:"corner"})),e&&e.options.allowUserDragFill||q&&"corner"===q.side&&(q.side=R)),q}function Fb(a,b,c,d){var e,f,g,h,i,j,k,l,m=!1,n=a.ITa.getSelections();for(e=0,f=n.length;e<f;e++){if(g=n[e],h=3===d||w(d),h&&(g=a.Tq(g)),i=g.row,j=g.col,k=g.rowCount,l=g.colCount,h)m=i<=b&&b<i+k&&j<=c&&c<j+l;else if(2===d)m=j===-1&&i<=b&&b<i+k;else if(1===d)m=i===-1&&j<=c&&c<j+l;else if(0===d)return m;if(m)break}return m}function Gb(a,b,c,d){if(!b){var e=Fa(a),f=e[e.length-1];c?3===d?(a.Jl=f.row+f.rowCount-1,a.Kl=f.col+f.colCount-1):2===d?(a.Jl=f.row+f.rowCount-1,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col+f.colCount-1):3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col)}}function Hb(a,b,c,d){var e=Fa(a),f=e[e.length-1];(b||c)&&(3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col))}function Ib(a){var b=this;b.KN=!1,b.hQ=new kb(a),b.iQ=new yb(a),b.kj=a}v.Zn(Ib),z(Ib.prototype,{jQ:function(a){var b=this,c=b.kj,d=c.am(),e=d.pt,f=d.qt,g=d.lt,h=d.ot,i=a.rN,j=0,k=b.kQ(i.X,i.Y),l=k.dragInfo,m=k.x,n=k.y;k&&(k.resizeInfo||l&&"corner"===l.side||k.selectionHitInfo)?(j|=2,j|=1):(f<=n&&n<h&&(j|=2),e<=m&&m<g&&(j|=1),j|=96,c.parent&&(j|=12)),a.DO=j},lQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o={e:a,r:R};if(Ib.ao(n,"preProcessManipulationStarted",o),!o.r)if(b=a.rN,c=n.kj,d=c.parent,e=c.mm,f=c.yl,g=n.kQ(b.X,b.Y),h=g.dragInfo,i=g.selectionHitInfo,c.yt=g,g.resizeInfo){if(!c.endEdit())return;e.fG(g)}else if(h&&"corner"===h.side)e.hG&&e.hG(g);else if(i){if(!c.endEdit())return;j=i.isHeader,k=i.isFirstIndicator,l=i.type,j&&e.ZG(g,!0),m=g.hitTestType,g.hitTestType=l,e.bH(g),g.hitTestType=m,Gb(c,j,k,l),c.mQ=!1,f.DH()}else c.nQ&&(c.nQ().oQ=!1),c.mQ=!1,f.DH(),a.HP>1&&d&&d.options.allowUserZoom?(n.KN=!1,n.hQ.OP()):(n.KN=!0,n.iQ.qG(1===a.HP))},pQ:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m={e:a,r:R};if(Ib.ao(l,"preProcessManipulationDelta",m),!m.r&&(b=a.rN,c=l.kj,d=c.mm,e=c.yt,f=b.X,g=b.Y,e))if(h=e.dragInfo,i=e.selectionHitInfo,e.resizeInfo)d.$F={e:a,x:f,y:g},d.WG();else if(h&&"corner"===h.side)d.$F={e:a,x:f,y:g},d.CG&&d.CG();else if(i||d.xG){if(i){if(!d.rG||!d.OG)return;if(d.DA===!0)return;j=i.type,d.$F={e:a,x:f,y:g},3===j?d.cH():2===j?d.dH():1===j&&d.eH()}}else l.KN?a.vO=l.iQ.NG(a.fP.sO,a.gP):(k=a.dP.rO,l.hQ.PP(k))},qQ:function(a){var b,c,d,e,f,g=this,h={e:a,r:R};Ib.ao(g,"preProcessManipulationCompleted",h),h.r||(b=g.kj,c=b.mm,b.mQ=!0,d=b.yt,e=d.selectionHitInfo,d.resizeInfo?c.YG():d.dragInfo&&c.BG?(c.xH&&c.xH(),b.parent.touchToolStrip.rQ()):e||c.xG?(c.hH(),e&&Hb(b,e.isHeader,e.isFirstIndicator,e.type),b.yl.im()):(b.nQ&&(b.nQ().oQ=!0),g.KN?g.iQ.gQ(a.gP):(f=a.dP.rO,g.hQ.SP(f))))},sQ:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G=this,H={e:a,r:R};if(Ib.ao(G,"preProcessTapped",H),!H.r)if(c=a.rN,d=G.kj,e=d.parent,f=!1,d.Uja=S,G.tQ(),d.uQ&&d.uQ(),g=d.ITa.Ky,g&&g.vQ(),h=d.mm,i=G.kQ(c.X,c.Y,!0),j=i.filterButtonHitInfo,k=i.hitTestType,l=i.row,m=i.col,n=i.outlineHitInfo)d.isEditing()||(o=n.what,p=d.rowOutlines,q=d.columnOutlines,"rg"===o||"rgh"===o?p&&p.UL(d,n):"cg"!==o&&"cgh"!==o||q&&q.UL(d,n));else if(d.yt=i,j){if(!d.endEdit())return;r=j.rowFilter,r&&r.openFilterDialog(j)}else if(i.resizeInfo);else if(d.Qs(i.rowViewportIndex<0?-1:l,i.colViewportIndex<0?-1:m)){if(d.wQ&&!h.BG&&e.touchToolStrip.rQ(),s=d.getActiveRowIndex(),t=d.getActiveColumnIndex(),u=i.cellTypeHitInfo){if(v=d.getCellType(u.row,u.col,k),u.sheet||(u.sheet=d),G.Sia(v,u))if(x=u.sheetArea,!w(x)&&3!==x||l===s&&m===t)d.yl.DH();else{if(d.suspendPaint(),!d.endEdit())return;if(y={sheet:d,sheetName:d.name(),row:s,col:t,cancel:!1},d.Wq(J.LeaveCell,y),y&&y.cancel===!0)return;z=d.ITa.getSelections(),A=d.ITa.getSpan(l,m),B=[I(A.row,A.col,A.rowCount,A.colCount)],d.yu(z,B),d.Wq(J.FloatingElementSelected,{type:"worksheet"}),C=u.isReservedLocation&&u.isFocusAware,d.Sr(l,m,S,S,C?0:1),D={sheet:d,sheetName:d.name(),row:l,col:m},d.Wq(J.EnterCell,D),d.Wq(J.FormulatextboxEnterCell,D),d.Au(z),d.Uja=!0,h.cs&&h.cs(l,m),d.resumePaint(),f=!0}v.processCellAndPaddingMouseDown(u),v.processMouseUp(u)}if(u&&u.isReservedLocation)return!0;d.Wq(J.CellClick,{sheet:d,sheetName:d.name(),sheetArea:k,row:i.row,col:i.col});try{if(h.mG=i,d.isEditing()&&s===d.getActiveRowIndex()&&t===d.getActiveColumnIndex()&&!d.endEdit())return}finally{h.mG=R}if(w(l)||w(m))return;3===k&&h.cs&&h.cs(l,m),Fb(d,l,m,k)&&!f?G.xQ=setTimeout(function(){var a={x:i.x,y:i.y,handled:!1},b=e.touchToolStrip;d.Wq(J.TouchToolStripOpening,a),a.handled||b.open(i.x,i.y-ca),G.tQ()},b+20):(d.Wq(J.FloatingElementSelected,{type:"worksheet"}),E=d.ITa.getSelections(),h.ZG(i),
F=d.ITa.getSelections(),d.yu(E,F),h.hH())}},Sia:function(a,b){return!(a&&a.activedOnClick&&!a.activedOnClick()&&b.isReservedLocation)},yQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=a.rN;if(n.tQ(),d=o.yt,d&&(o.Wq(J.CellDoubleClick,{sheet:o,sheetName:o.name(),sheetArea:d.hitTestType,row:d.row,col:d.col}),e=d.resizeInfo))if(f=o.ITa.getSelections(),"sizeRow"===e.action||"sizeHiddenRow"===e.action){if(g=[],o.tp(e.index)){for(b=0;b<f.length;b++)if(c=f[b],c.col===-1)for(c=o.Tq(c),h=0;h<c.rowCount;h++)g.push({row:c.row+h})}else g.push({row:e.index});o.wu().execute({cmd:"autoFitRow",sheetName:o.name(),rows:g,columnHeader:1===e.sheetArea})}else{if(i=[],o.sp(e.index)){for(b=0;b<f.length;b++)if(c=f[b],c.row===-1)for(c=o.Tq(c),j=0;j<c.colCount;j++)i.push({col:c.col+j})}else i.push({col:e.index});o.wu().execute({cmd:"autoFitColumn",sheetName:o.name(),columns:i,rowHeader:2===e.sheetArea})}else k=n.kQ(p.X,p.Y,!0),!(k&&k.row>=0&&k.col>=0&&k.rowViewportIndex>=0&&k.colViewportIndex>=0)||k.resizeInfo||o.options.isProtected&&o.tq(k.row,k.col,"locked")||(o.Tr(),l=o.Er(k.row),m=o.Fr(k.col),o.Kr(k.row,k.col,l,m,!0),o.addSelection(k.row,k.col,1,1),o.mm.dI(!1,!0),o.EF(o.Ws(),k.row,k.col))},zQ:function(a){var b,c=this,d=c.kj,e=a.rN,f=c.kQ(e.X,e.Y);d.isEditing()?f.row===d.Jl&&f.col===d.Kl||d.mm.cI(f):(c._target=f,b=c.kQ(e.X,e.Y,!0),b&&b.cellTypeHitInfo&&b.cellTypeHitInfo.isEditting||d.mm.cI(b))},AQ:function(){var a,b,c,d,e=this,f=e.kj;f.isEditing()||(a=e._target,b=!0,a&&(c=a.cellTypeHitInfo,c&&c.isReservedLocation?b=!1:(d=f.getCellType(a.row,a.col),d&&d.isEditting()&&(b=!1))),b&&f.mm.dI(!0))},kQ:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kj;return t.am(),d={x:a,y:b,rowViewportIndex:R,colViewportIndex:R,row:-1,col:-1,resizeInfo:R,hitTestType:R,outlineHitInfo:R,filterButtonHitInfo:R,dragInfo:R,cellTypeHitInfo:R,selectionHitInfo:R},e=t.rowOutlines,f=t.columnOutlines,e&&(g=e.hitTest(t,a,b)),!g&&f&&(g=f.hitTest(t,a,b)),g?d.outlineHitInfo=g:(h=t.nr(b),i=t.or(a),d.rowViewportIndex=h,d.colViewportIndex=i,d.row=t.pr(b,h),d.col=t.qr(a,i),h>=0&&h<=2&&i>=0&&(j=t.rr(h,i,S,d.row,d.col),j&&(d.row=j.row,d.col=j.col)),d.hitTestType=t.sr(h,i),k=Cb(t,d,a,b,10),m=t.xr,n=m&&m.hitTest(d,a,b),n||(p=t.tables,q=p&&p.find(d.row,d.col),r=q&&q.xr,n=r&&r.hitTest(d,a,b)),t.wQ?(l=Eb(t,d,a,b),d.dragInfo=l):k?d.resizeInfo=k:n?d.filterButtonHitInfo=n:c?d.cellTypeHitInfo=t.yr(d,a,b):(o=Db(t,d,a,b),d.selectionHitInfo=o)),d},tQ:function(){var a=this,b=a.xQ;b&&(clearTimeout(b),a.xQ=R)}}),t.TouchEventHandler=Ib;function Jb(a,b,c){var d=this;d.BQ=c,d.yM=new Ob(b),d.CQ=new Ib(b),d.DQ=new Pb(a,"sheet",d.yM,100,10),d.BQ.xN(d.DQ,!0)}z(Jb.prototype,{EQ:function(){var a=this,b=a.CQ,c=a.DQ;c.dN=function(a){return b.jQ(a)},c.eN=function(a){return b.lQ(a)},c.fN=function(a){return b.pQ(a)},c.hN=function(a){return b.qQ(a)},c.iN=function(a){return b.sQ(a)},c.jN=function(a){return b.yQ(a)},c.GM=function(a){return b.zQ(a)},c.IM=function(a){return b.AQ(a)}},FQ:function(){var a=this,b=a.DQ;b&&(a.BQ.xN(b,!1),b.dN=R,b.eN=R,b.fN=R,b.gN=R,b.hN=R,b.iN=R,b.jN=R,b.kN=R,b.GM=R,b.IM=R,a.DQ=R)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}}),h="gc-toolstrip-button",i="gc-toolstrip-text",j="gc-toolstrip-image",k="gc-toolstrip-item",l="gc-touch-sperate-line",m="height",n="width",o="px",p="button",B(Kb,x);function Kb(a,b){var c,d=this;x.call(d,b,C.vl(a.qo)),d.JQ=32,d.KQ=45,d.LQ={},d.MQ=!1,d.OC=a,c=d.yo(),d.NQ=c,c.addClass("gc-toolstrip-default ui-state-default well"),c.appendTo(d.zo()),c.hide(),d.OQ(),d.PQ(),d.QQ()}z(Kb.prototype,{open:function(a,b){var c,d,e,f,g=this,h=Ea(g.OC);if(h&&(G.Zl(R,!0),g.NQ.css({left:a,top:b}),g.Ao(),g.MQ=!0,g.Do(),!A(g.LQ))){c=g.LQ;for(d in c)c.hasOwnProperty(d)&&(e=c[d],f=!e.RQ||e.RQ.call(g),f?y("#"+d).show():y("#"+d).hide())}},add:function(a){var b,c,d,e;a&&(b=this,c=b.LQ,a instanceof Nb?(d=a.name(),d&&(c[d]=a,b.SQ(a.TQ(l,b.KQ+o)))):a instanceof Mb&&(e=a.name(),b.getItem(e)||(c[e]=a,b.SQ(a.TQ(j,b.JQ+o,i,h)))))},getItem:function(a){return this.LQ[a]},getItems:function(){var a,b=this,c=[],d=b.LQ;if(!A(d)){for(a in d)d.hasOwnProperty(a)&&c.push(d[a]);return c}return R},remove:function(a){var b,c=this;return c.getItem(a)?(y("#"+a).parent().remove(),b=c.LQ[a],delete c.LQ[a],b):R},clear:function(){var a=this;a.NQ&&(a.NQ.find("td."+k).remove(),a.LQ={})},close:function(){var a,b,c=this;ua.Hm(),c.NQ&&c.NQ.hide(),c.MQ=!1,c.Eo(),a=Ea(c.OC),a&&(a.zt(),b=Fa(a),b.length>0&&!a.wQ&&b[0].row===-1&&b[0].col===-1&&a.Tr())},imageAreaHeight:function(a){var b=this;return 0===arguments.length?b.JQ:(a>0&&(b.JQ=a,b.NQ.find("span."+j).css(m,a+o)),b)},itemHeight:function(a){var b=this,c=b.NQ.find("button."+h);return 0===arguments.length?ra(c.css(m)):(a>0&&c.css(m,a+o),b)},itemWidth:function(a){var b,c,d=this,e=d.NQ.find("button."+h);return 0===arguments.length?ra(e.css(n)):(a>0&&(b="min-width",c=ra(e.css(b)),c>a&&e.css(b,a+o),e.css(n,a+o)),d)},separatorHeight:function(a){var b=this;return 0===arguments.length?b.KQ:(a>0&&(b.KQ=a,b.NQ.find("div."+l).css(m,a+o)),b)},OQ:function(){var a="table",b=this,c=y(D(a)).css({padding:0,display:a}).attr({cellspacing:0,cellpadding:0});b.UQ=y(D("tr")).appendTo(c),c.appendTo(b.NQ)},no:function(){var a=this,b=a.NQ;b&&(a.MQ&&ua.Hm(),b.remove(),a.Eo(),a.NQ=R)},QQ:function(){var a=this;a.NQ.bind("click",function(b){var c,d,e,f=b.target,g=f.tagName.toLowerCase();g===p?c=f.id:(d=f.parentElement,d&&d.tagName.toLowerCase()===p&&(c=d.id)),e=a.LQ[c],c&&e&&e.VQ.call(a)})},SQ:function(a){this.NQ&&a&&y(D("td")).append(a).appendTo(this.UQ).addClass(k)},PQ:function(){var a,b,c,d,e,f,g;function h(a){for(var b=0,c=a+b;ta.getElementById(c);)b++,c=a+b;return c}a="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",b={0:va+a+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+wa,1:va+a+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+wa,2:va+a+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:va+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},c=this,d=b[0],e=b[1],f=b[2],g=b[3],c.WQ=new Mb(h("wijspread_toolstrip_paste"),ya().ToolStrip_PasteText,d,c.XQ),c.YQ=new Mb(h("wijspread_toolstrip_cut"),ya().ToolStrip_CutText,e,c.ZQ),c.$Q=new Mb(h("wijspread_toolstrip_copy"),ya().ToolStrip_CopyText,f,c._Q),c.aR=new Mb(h("wijspread_toolstrip_autofill"),ya().ToolStrip_AutoFillText,g,c.bR,c.cR),c.add(c.WQ),c.add(c.YQ),c.add(c.$Q),c.add(new Nb(c.cR)),c.add(c.aR)},cR:function(){var a,b,c,d=Ea(this.OC);if(!d)return!1;for(a=Fa(d),b=0;b<a.length;b++)if(c=a[b],c.row===-1&&c.col===-1)return!1;return!0},bR:function(){var a,b;this.close(),a=Ea(this.OC),a&&(b=Fa(a).length,b<=1&&(a.wQ=!0,a.yl.im()))},rQ:function(){var a=Ea(this.OC);a&&(a.wQ=!1,a.yl.im())},_Q:function(){var a=Ea(this.OC);a&&(this.dR=a.ux(!0)),this.close()},ZQ:function(){var a=Ea(this.OC);a&&(this.dR=a.sx(!0)),this.close()},XQ:function(){var a=this,b=a.dR,c=Ea(a.OC);c&&!w(b)&&c.vx({pasteHtml:b.copyHtml,pasteText:b.copyText}),a.close()},eR:function(){var a=this,b="span."+i;y("#"+a.WQ.Cj).find(b).text(ya().ToolStrip_PasteText),y("#"+a.YQ.Cj).find(b).text(ya().ToolStrip_CutText),y("#"+a.$Q.Cj).find(b).text(ya().ToolStrip_CopyText),y("#"+a.aR.Cj).find(b).text(ya().ToolStrip_AutoFillText)}}),t.TouchToolStrip=Kb;function Lb(a,b,c){var d,e=D("span"),f=ta.body;return e.className=c,e.style.font=a,e.style.cssFloat="left",e.textContent=b,f.insertBefore(e,R),d=y(e).width(),f.removeChild(e),d}function Mb(a,b,c,d,e){this.MC="normal 12px Arial";var f=this;f.Cj=a,f._text=b,f.fR=c,d&&(f.VQ=d),e&&(f.RQ=e)}z(Mb.prototype,{name:function(a){var b=this;return 0===arguments.length?b.Cj:(y("#"+b.Cj).attr("id",a),y("#"+b.Cj+"Text").attr("id",a+"Text"),y("#"+b.Cj+"Image").attr("id",a+"Image"),b.Cj=a,b)},text:function(a){var b=this;return 0===arguments.length?b._text:(b._text=a,y("#"+b.name()+"Text").text(a),b)},font:function(a){var b=this,c=y("#"+b.name()+"Text");return 0===arguments.length?b.MC:(b.MC=a,c.css("font",a),b)},foreColor:function(a){var b=this,c=y("#"+b.name()+"Text");return 0===arguments.length?b.Nra?b.Nra:c.css("color"):(c.css("color",a),b)},image:function(a){var b=this;return 0===arguments.length?b.fR:(b.fR=a,y("#"+b.name()+"Image").css("background-image","url("+a+")"),b)},TQ:function(a,b,c,d){var e,f,g,h,i=this,j=i.name(),k=i.font(),l=i.text(),m=y(D("span"));return m.attr("id",j+"Image"),m.addClass(a),m.css({"background-image":"url("+i.image()+")","background-repeat":"no-repeat",display:"block",height:b,"background-position-x":"50%"}),e=y(D("span")),e.attr("id",j+"Text"),e.addClass(c),e.css("font",k),e.text(l),f=Lb(k,l,c),g=60,f>g&&(g=f),h=y(D(p)),h.attr("type",p),h.attr("id",j),h.addClass(d+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),h.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:g+o}),h.append(m),h.append(e),h[0]}}),t.TouchToolStripItem=Mb;function Nb(a){function b(){for(var a="separator",b=0,c=a+(""+b);ta.getElementById(c);)b++,c=a+(""+b);return c}this.Cj=b(),a&&(this.RQ=a)}z(Nb.prototype,{name:function(){return this.Cj},TQ:function(a,b){var c=y(D("div"));return c.attr("id",this.name()),c.addClass(a),c.css({width:"1px",height:b,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),c[0]}}),t.TouchToolStripSeparator=Nb;function Ob(a){this.tc=a}z(Ob.prototype,{oN:function(){this.gR=2,this.tc.CH=!0},zM:function(){this.gR=0,this.hR=Ca()},nN:function(){return 1===this.gR},uN:function(){return 1===this.gR},sN:function(){return 1===this.gR},GQ:function(){var a=this;if(2===a.gR)return!0;if(a.hR){if(Ca()-a.hR<=200)return a.iR++,!0;a.hR=0,a.iR=0,a.gR=1}else a.gR=1;return a.tc.CH=!1,!1},HQ:function(){var a=this;return a.iR?(a.iR--,!0):2===a.gR||(a.gR=0,!1)},IQ:function(){return 2===this.gR}}),t.jR=Ob;function Pb(a,b,c,d,e){var f=this;f.KM=a,f.lN=c,f.OM=b,f.mN=d,f.aN=e}t.kR=Pb;function Qb(){}z(Qb.prototype,{lR:function(a,b){var c,d,e=a,f=e.touches,g=e.targetTouches,h=e.changedTouches;e.isPrimary!==!1&&(f&&f.length>=1&&g&&g.length>=1&&(f[0].clientX!==g[0].clientX||f[0].clientY!==g[0].clientY)||(M(a),c=w(h)?e:h[0],d=ta.createEvent("MouseEvents"),d.initMouseEvent(b,!0,!0,sa,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,R),a.target.dispatchEvent(d)))},NM:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,b.mR)return;b.mR=!0,b.nR=!1,b.lR(a,"mouseover"),b.lR(a,"mousemove"),b.lR(a,"mousedown")}},aB:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,!b.mR)return;b.nR=!0,b.lR(a,"mousemove")}},RM:function(a){var b,c=a.pointerType;if(!c||c===a[oa]||c===da){if(b=a.data,!b.mR)return;b.lR(a,"mouseup"),b.lR(a,"mouseout"),b.nR||b.lR(a,"click"),b.mR=!1}},oR:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=c.charAt(0);"."!==p&&(c="."+c),d=fa+c,e=ga+c,f=ha+c,g=ia+c,h=ja+c,i=ka+c,j=la+c,k=ma+c,l=na+c,m=C._Va(),b?m?(n=a.style,w(n.msTouchAction)||(n.msTouchAction=ea),w(n.touchAction)||(n.touchAction=ea),y(a).bind(d,o,o.NM).bind(g,o,o.NM),y(ta).bind(e,o,o.aB).bind(h,o,o.aB).bind(f,o,o.RM).bind(i,o,o.RM)):y(a).bind(j,o,o.NM).bind(k,o,o.aB).bind(l,o,o.RM):m?(y(a).unbind(d).unbind(g),y(ta).unbind(e).unbind(h).unbind(f).unbind(i)):y(a).unbind(j).unbind(k).unbind(l)}}),t.pR=Qb,q="newSheet",r="tab";function Rb(a){this.hq=a}z(Rb.prototype,{lQ:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=a.rN,n=l.hq,o=Ea(n.OC);n.FD&&n.GD(o,!1),b="resize",c=n.hitTest(m.X,m.Y),d=c.element,d===b?(n.HD=!0,n.ID=m.X):d!==r&&d!==q&&""!==d||(e=n.Xs,f=H.Nn(e),g=H.On(e),h=l.IP(f,g),i=h.getContext("2d"),j=H.Ln(h),k=H.Mn(h),xa.Cn(i,1,1),i.drawImage(e,0,0,Aa(h),za(h),0,0,Aa(h),za(h)),xa.Cn(i,j,k),l.Xs=h,l.qR=n.gq,l.rR=n.VC(),l.sR=n.UC(),l.KC=n.TC(),n.SC=!0),l.tR=n.jw(-1),l.uR=n.rD(n.sD())},pQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,G,I=this,J=a.rN.X,K=I.hq;if(K.HD)b=J-K.ID,c=K.OC,d=c.options,e=c.xs.clientWidth,d.tabStripRatio=c.Iv()+b/e,f=K.kw/e,g=1,c.Iv()<f?(d.tabStripRatio=f,K.ID=K.kw):c.Iv()>=g?(d.tabStripRatio=g,K.ID=e):K.ID=J;else{if(h=I.Xs,i=I.qR,!h||w(i))return;j=I.tR,k=I.uR,l=I.KC,m=I.rR,n=I.sR,o=a.dP.sO.X,p=I.vR(o,i),K.gq=p.gq,q=p.Vo,o>0&&i===j&&K.gq===j?q=0:o<0&&i===k&&K.gq===k&&(q=0),o>0&&o>q+l?o=q+l:o<0&&o<q-l&&(o=q-l),0!==o&&(r=K.Xs,s=r.getContext("2d"),t=H.Ln(r),u=H.Mn(r),s.save(),s.clearRect(0,0,H.Nn(r),H.On(r)),v=K.Dr(),K.dD(s,v),y=0,A=za(v),o>0?(x=m,B=x+o,z=n-B,z>0&&(xa.Cn(s,1,1),s.drawImage(h,x*t,y,z*t,A*u,B*t,y,z*t,A*u),xa.Cn(s,t,u)),C=o-q,n-m<=o&&(C=0),z=q,x=m,z>0&&(xa.Dn(s,C,0),K.iE(s,new F(x,y,z,A)),xa.Dn(s,-C,0))):o<0&&(B=m,x=B+T(o),z=n-x,z>0&&(xa.Cn(s,1,1),s.drawImage(h,x*t,y,z*t,A*u,B*t,y,z*t,A*u),xa.Cn(s,t,u)),C=o-q,n-m<=T(o)&&(C=0),z=T(q),x=n-z,z>0&&(xa.Dn(s,C,0),K.iE(s,new F(x,y,z,A)),xa.Dn(s,-C,0))),xa.Cn(s,1,1),x=0,z=m,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u),D=E.Lm(""),G=qa(D.zIndex),G>2007&&(x=n,z=v.x+Aa(v)-K.kw-x,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u)),x=Aa(v)-K.kw,z=K.kw,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u),xa.Cn(s,t,u),s.restore())}},qQ:function(){var a=this.hq;a.HD?(a.HD=!1,a.OC.aq()):(a.SC=S,a.repaint())},sQ:function(a){var b,c,d,e,f=this.hq,g=f.OC,h=a.rN,i=Ea(g);f.FD&&f.GD(i,!1),b=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],c=f.hitTest(h.X,h.Y),d=c.element,g.mv=!0;try{b.indexOf(d)>=0?f.JD(c.index,!0):d===r?f.KD(c.index,c.position):d===q&&f.MD(c.position)}finally{g.mv=!1,e=Ea(g),e!==i&&(e.CH=!0,e.zt())}},yQ:function(a){return this.hq.cE(a.rN.X,a.rN.Y)},IP:function(a,b){var c=this.Xs;return c?a===H.Nn(c)&&b===H.On(c)||H.Pn(c,a,b):(c=D("canvas"),H.Kn(c,this.hq.OC),H.Pn(c,a,b)),c},vR:function(a,b){var c=this,d=c.hq,e=d.WC,f=c.tR,g=c.uR,h=b,i=0;if(a>0){for(;h>=f&&!(i>a);)i+=e[h],h--;h<f&&(h=f)}else if(a<0&&g!==-1){for(;h<=g&&!(i<a);)i-=e[h],h++;h>g&&(h=g)}return{gq:h,Vo:i}}});function Sb(a,b,c){var d,e,f=this;f.yM=new Ob(f),f.DQ=new Pb(a,"tabStrip",f.yM,1,(-1)),f.BQ=c,f.CQ=new Rb(b),d=f.CQ,e=f.DQ,e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)},e.jN=function(a){return d.yQ(a)}}z(Sb.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function Tb(a,b,c,d){var e=a.vu();e.ko(b)?c.drawImage(e.lo(b),d.x,d.y,Aa(d),za(d)):e.fo(b)}function Ub(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=16,r=Fa(a);a.CH&&r.length>0&&(g=r[r.length-1],h=g.row,i=g.row+g.rowCount-1,j=g.col,k=g.col+g.colCount-1,l=a.parent,m="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",l&&!l.options.allowUserResize||(h!==-1&&j===-1&&a.getRowResizable(i)?(n=a.Er(i),c=va+m+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",d=a.getCellRect(i,Ia(a,2)-1,n,-1),f=p.fm(n),f.y<=d.y&&d.y+za(d)<=f.y+za(f)&&(e=new F(p.kt-q,d.y+za(d)-q/2,q,q))):h===-1&&j!==-1&&a.getColumnResizable(k)&&(o=a.Fr(k),c=va+m+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+wa,d=a.getCellRect(Ja(a,1)-1,k,-1,o),f=p.gm(o),f.x<=d.x&&d.x+Aa(d)<=f.x+Aa(f)&&(e=new F(d.x+Aa(d)-q/2,p.nt-q,q,q))),c&&e&&Tb(a,c,b,e)))}function Vb(a){var b,c,d,e,f=R,g=Fa(a),h=g.length;return a.CH&&h>0&&(b=g[h-1],c=a.cm(b),d=17,e=20,f=new F(c.x+Aa(c)-d,c.y+za(c),d,e)),f}function Wb(a,b,c){var d=a.Er(b),e=a.Fr(c),f=a.jt(d),g=a.it(e),h=0,i=0,j=0,k=0;return f.length>0&&(h=f[0].row,i=f[f.length-1].row),g.length>0&&(j=g[0].col,k=g[g.length-1].col),I(h,j,i-h+1,k-j+1)}function Xb(a,b,c){var d,e,f,g=a.Er(b),h=a.Fr(c),i=a.am(),j=i.Ft(g,h),k=!1,l=a.it(h),m=c===-1?l[0]:l.findCol(c);return m&&(k=j.x<=m.x&&m.x+Aa(m)<=j.x+Aa(j)),d=!1,e=a.jt(g),f=b===-1?e[0]:e.findRow(b),f&&(d=j.y<=f.y&&f.y+za(f)<=j.y+za(j)),k&&d}function Yb(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I=Fa(a),J=[];if(a.CH&&I.length>0)for(b=I[I.length-1],c=a.cm(b),d=8,e=a.am(),f=b.row,g=b.row+b.rowCount-1,h=b.col,i=b.col+b.colCount-1,j=Wb(a,f,h),k=Wb(a,g,i),l=j.row,m=k.row+k.rowCount-1,n=j.col,o=k.col+k.colCount-1,r=g===m&&Xb(a,m,-1),s=i===o&&Xb(a,-1,o),b.row!==-1&&b.col!==-1?(n<=h&&h<=o&&l<=f&&f<=m&&(J[0]=new F(c.x-d,c.y-d,2*d,2*d)),(n<=i&&i<o||s)&&(l<=g&&g<m||r)&&(J[1]=new F(c.x+Aa(c)-d,c.y+za(c)-d,2*d,2*d))):b.row!==-1?(p=e.Ft(1,0),q=e.Ft(1,1),t=p.x+(Aa(p)+Aa(q))/2-d,u=Ia(a)-1-Ga(a),v=a.it(1),w=v.findCol(u),w&&(x=a.it(0),y=x[0]||v[0],y&&(t=y.x+(w.x+Aa(w)-y.x)/2-d)),l<=f&&f<=m&&(J[0]=new F(t,c.y-d,2*d,2*d)),(l<=g&&g<m||r)&&(J[1]=new F(t,c.y+za(c)-d,2*d,2*d))):b.col!==-1&&(p=e.Ft(0,1),q=e.Ft(1,1),z=p.y+(za(p)+za(q))/2-d,A=Ja(a)-1-Ha(a),B=a.jt(1),C=B.findRow(A),C&&(D=a.jt(0),E=D[0]||B[0],E&&(z=E.y+(C.y+za(C)-E.y)/2-d)),n<=h&&h<=o&&(J[0]=new F(c.x-d,z,2*d,2*d)),(n<=i&&i<o||s)&&(J[1]=new F(c.x+Aa(c)-d,z,2*d,2*d))),H=J.length-1;H>=0;H--)G=J[H],(!G||G.x<0||G.y<0)&&(J[H]=R);return J}function Zb(a,b,c){var d,e,f,g;if(v.needPaintSelection(a)){if(a.isEditing()||!b||0===a.selectionPolicy())return;if(d=Yb(a),e=d.length,e>0){for(c.save(),c.fillStyle=a.m_a()||"white",c.strokeStyle=a.getSelectionBorderColor(),g=0;g<e;g++)f=d[g],f&&(c.beginPath(),c.arc(f.x+Aa(f)/2,f.y+za(f)/2,Aa(f)/2,0,2*Math.PI,!1),c.fill(),c.stroke());c.restore()}}}function $b(a,b){var c,d=Vb(a);d&&(c=va+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+wa,Tb(a,c,b,d))}v.oJ.prototype.DH=function(){var a=this,b=a.kj,c=Fa(b),d=c.length;b.Xq<=0&&d>0&&a.im(c[d-1],S,S,!0)},v.Worksheet.$n(da,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(a){var b=this,c=b.parent,d=c&&c.BQ||new La,e=new Jb(a[0],b,d);e.EQ(),b.wR=e},dispose:function(a){var b=this;b.wR&&b.wR.FQ(),a!==!1&&(b.wR=R)},startEdit:function(){this.yl.DH()},paintAdornment:function(a){var b=this,c=a.ctx;b.CH&&(b.options.isProtected||Ub(b,c),b.wQ?$b(b,c):Zb(b,b.mQ,c))},preProcessMouseDown:function(a){var b=a.e,c=this.wR;(Q||c.GQ(b))&&(M(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;(Q||c.IQ(b))&&(M(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;(Q||c.HQ(b))&&(M(b),a.r=!0)},preProcessMouseDbClick:function(a){(Q||this.CH)&&(a.r=!0)},preProcessMouseOut:function(a){Q&&(a.r=!0)},preProcessMouseWheel:function(a){Q&&(a.r=!0)}}),v.Workbook.$n(da,{init:function(){this.BQ=new La},setHost:function(){var a=this;a.touchToolStrip=new Kb(a,a.xv())},dispose:function(){var a=this,b=a.BQ,c=a.touchToolStrip;b&&b.no(),c&&(c.no(),a.touchToolStrip=R)},onCultureChanged:function(){var a=this.touchToolStrip;a&&a.eR()}}),v.DC.$n(da,{setHost:function(){var a=this,b=new Sb(a.Xs,a,a.OC.BQ);b.EQ(),a.wR=b},dispose:function(){var a=this,b=a.wR;b&&(b.FQ(),a.wR=R)},preProcessMouseDown:function(a){var b=this.wR,c=a.e;(Q||b.GQ(c))&&(M(c),a.r=!1)},preProcessMouseMove:function(a){var b=this.wR,c=a.e;(Q||b.IQ(c))&&(M(c),a.r=!1)},preProcessMouseUp:function(a){var b=this.wR,c=a.e;(Q||b.HQ(c))&&(M(c),a.r=!1)},preProcessMouseDbClick:function(a){var b=Ea(this.OC);(Q||b.CH)&&(a.r=!1)},preProcessMouseOut:function(a){Q&&(a.r=!1)}}),s=".gcScrollbar",v.hv.$n(da,{initEvents:function(a){var b=this.xR=new Qb;b.oR(a,!0,s)},dispose:function(a){var b=this.xR;b&&b.oR(a,!1,s)}}),a.exports=t}()},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){!function(){"use strict";a.exports={ToolStrip_PasteText:"Paste",ToolStrip_CutText:"Cut",ToolStrip_CopyText:"Copy",ToolStrip_AutoFillText:"AutoFill"}}()}]);