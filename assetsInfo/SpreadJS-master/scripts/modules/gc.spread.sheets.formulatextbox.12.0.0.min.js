/*!
 * 
 * Spread.Sheets Library 12.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FormulaTextBox=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(5),c(6),c(7),c(8),b.SR={},b.SR.en=c(9),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g=c(2),h=c(3),i=g.CalcEngine,j=c(4),k={},l=null,m=void 0,n=Math.max,o=Math.min,p=g.GC$,q=p.extend,r=g.Ul.Nl,s=window,t=document,u=j.u,v=g.Ul,w=v.nl,x=v.Ml,y=x.msie&&parseInt(x.version,10)<10,z=u.Nb,A="formulatextbox",B="gcUIElement",C="input",D="\xa0",E=".gcFormulaTextBoxInternal",F=".gcFormulaTextBox",G="TextChanged",H="CaretChanged",I="AppendStarted",J="AppendEnded",K={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},L=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],M='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',N='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',O=function(){return j.C(k.SR)()};function P(a){return a.getActiveSheet()}function Q(){var a=[];return p.each(j.C(h.SR)()._h,function(b,c){h.Functions.bi[b]&&(c.name=b,a.push(c))}),a}function R(a){var b=[],c;return p.each(a,function(a,d){c=d.description(),c&&(c.name=a,b.push(c))}),b}function S(a,b){if(!a)return!1;var c=!1,d=!1;if(1===b.rowCount){if(a.hasHeadersRow()&&b.row===a.startRow())return!0;if(a.hasTotalsRow()&&b.row===a.endRow())return!0}else a.hasHeadersRow()&&b.row===a.startRow()&&(b.rowCount===a.dataRange().rowCount+1&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1+1&&(c=!0)),b.row===a.dataRange().row&&(b.rowCount===a.dataRange().rowCount&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1&&(c=!0));return b.col+b.colCount<=a.startColumn()+a.dataRange().colCount&&(d=!0),c&&d}function T(a){var b=a.name();return i.jma(b.split(""),!1)?b:"'"+b+"'"}function U(a,b){var c,d,e,f,h,j,m,n,o,p,q;return b?(c=k.G0.H0,d=c&&c.kj||a,e=d.Jl,f=d.Kl,h=a.parent,j=h&&1===h.options.referenceStyle,m=15,a.Cw&&a.Cw.Nfa&&(m=0),b.row<0&&b.col<0&&(b=new g.Range(0,(-1),a.getRowCount(),(-1))),n=a.tables,o=n&&n.find(b.row,b.col),c&&c.Nfa&&(m=0),S(o,b)?(c&&c._text&&c.kj!==a&&(e=f=-1),i.rangeToFormulaWithStructReference(a,b,e,f,m,j,o)):(p=i.rangeToFormula(b,e,f,m,j),(c&&c._text||a.Cw&&a.Cw.V4&&a.Cw.ria)&&(q=T(a),p=q+"!"+p),p)):l}k.C2=U,g.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",g.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",s.Yl.km.push(function(a,b){var c,d=k.G0;!b&&a.endEdit&&d&&(c=d.H0,c&&c.I0&&a.Cw&&(a.Cw&&a.Cw.destroy(),a.Cw=l,c.$b()))});function V(a,b){var c,d,e,i,j,k=a.parent,l=k&&k.options;b&&l&&l.allowUserEditFormula&&l.enableFormulaTextbox&&(a.Cw&&a.Cw.destroy(),a.Cw=new f(b,null,k),c=a.Cw.text(),d=a.getFormulaInformation(a.Jl,a.Kl),"="!==c[0]||d&&d.hasFormula||(c="'"+c,a.Cw.text(c)),e=a.Cw,i=a.mm,j=a.yl,e.bind("AppendStarted",function(){e.close();var b=a.Px;1!==b&&(a.Px=1,a.Cu(b,1))}),e.bind("AppendEnded",function(){j.uH()}),e.bind(G,function(b,c){if(!a.Js){if(c&&c.type!==C){i.Qw(c);var d=a.Jl,f=a.Kl,h=a.getCellType(d,f);a.Wq(g.Events.EditChange,{sheet:a,sheetName:a.name(),row:d,col:f,editingText:h.getEditorValue(a.BF)})}j.uH(),a.Wq(g.Events.FormulaTextBoxTextChanged,{sheet:a,sheetName:a.name(),text:e.text()})}}),e.bind("CaretChanged",function(){j.uH(),a.Wq(g.Events.FormulaTextBoxCaretChanged,{sheet:a,sheetName:a.name(),caret:e.caret()})}),e.add(Q()),e.add(R(h.Functions.ci)),e.add(R(a.Su).concat(R(k.Su))),j.uH())}k.J0=V;function W(a){a.Cw&&(a.Cw.destroy(),a.Cw=l,a.yl.uH());var b=a.parent&&a.parent.CF;t.activeElement===(b&&b.qo)&&a.mm.Qq()}k.K0=W;function X(a,b){var c,d,e,f;if(!b)return l;c=k.G0.H0,d=c&&c.kj||a,e=d.Jl,f=d.Kl;try{return i.formulaToRange(a,b,e,f)}catch(a){}return l}k.L0=X,q(g.DC.prototype,{bE:function(a){return!(a&&a.Cw&&a.Cw.M0())}}),g.Worksheet.$n(A,{startEdit:function(a){V(this,a.element)},endEdit:function(){W(this)}}),b=g.DC,d=b.prototype,e=d.dE,b.$n(A,{preProcessMouseDbClick:function(a){var b=P(this.OC),c=b.Cw,d=c&&c.M0(),e=k.G0.H0;d?a.r=!1:e&&e.I0&&e.$b()}}),d.dE=function(){var a=P(this.OC),b=a.Cw,c=k.G0.H0,d=c&&c._text;return e.call(this)&&!d&&!b},f=function(){var a=1;function b(b,d,e){var f,h,i,j,l=this,m=b;if(l.V4=!1,l.Nfa=!1,l.ria=!0,l.Ac=[],l.Bc=[],d&&d.rangeSelectMode&&(d.absoluteReference===!0&&(l.Nfa=!0),d.needSheetName===!1&&(l.ria=!1),l.V4=!0,l.D5=!1,l.E5=!1,l.cga=b,f=c(b,l),m=f.contentDiv,l.sia=f.button,l.tia=b,l.C5=a++),l.UQa=!0,l.ad(e&&e.getHost()||t.body),m&&l.N0(m),e&&(l.O0=!0,l.P0(e),l.OC.Gu(g.Events.FormulatextboxActiveSheetChanging,k.G0.Q0),l.OC.Fu(g.Events.FormulatextboxActiveSheetChanging,k.G0.Q0),l.OC.Gu(g.Events.FormulatextboxActiveSheetChanged,k.G0.R0),l.OC.Fu(g.Events.FormulatextboxActiveSheetChanged,k.G0.R0)),h=l.text(),l.S0=l.T0(h),i=l.Cia(m)){l.V0(l.S0);try{j=s.getSelection(),j.selectAllChildren(m),j.rangeCount>0&&j.collapseToEnd()}catch(a){}p(l.qo).data("text-before",h)}}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m=p(a);return m.attr("contenteditable","false"),c=r("table"),p(c).css("border-spacing","0"),p(c).css("width","100%"),m.append(c),d=r("tbody"),c.appendChild(d),e=document.createElement("tr"),d.appendChild(e),f=document.createElement("td"),p(f).css("padding-right","0px"),e.appendChild(f),g=document.createElement("td"),p(g).css("width","23px"),p(g).css("padding-right","0px"),e.appendChild(g),h=m.width()-p(g).width(),i=r("div"),j=r("div"),p(j).width(h),p(j).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),j.appendChild(i),f.appendChild(j),k=r("div"),g.appendChild(k),p(i).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),p(i).width(h),p(i).attr("contenteditable","true"),p(i).attr("spellcheck","false"),l=p(k),l.css({display:"block",float:"right",width:"23px",height:"23px",background:M,"background-repeat":"no-repeat"}),l.bind("click",function(){b.D5?(b.OC.Wq("RangeSelectEnding",b),b.endSelectMode()):b.startSelectMode()}),{contentDiv:i,button:k}}function d(a){var b=r("textarea"),c=p(b);return c.css({display:"none"}),p(a).append(b),b}return k.W4=d,b.prototype={constructor:b,j5:function(a){var b,c,e,f,g,h,i=this;i.O1(),i.UF(),i.E5=!0,b=d(i.OC.qo),c=i.a1(),c.suspendPaint(),V(c,b),e=c.Cw,e.V4=!0,e.C5=i.C5,e.Nfa=i.Nfa,e.ria=i.ria,a&&(i.text(a),i.caret(a.length)),f=i.text(),g=i.caret(),g<=0&&(g=f.length),i.focus(),i.caret(g),i.MH=!0,i.W0=1,h=f.lastIndexOf(",",g),h!==-1&&(i.W0=h+1),f||(i.text("="),f="=",i.caret(1),g=1),0!==f.indexOf("=")&&(f="="+f,g++),e.text(f),e.caret(g),e.MH=i.MH,e.W0=i.W0,c.resumePaint()},startSelectMode:function(a){var b,c=a;c&&0!==c.indexOf("=")&&(c="="+c),b=this,b.V4=!0,b.D5=!0,p(b.sia).css({background:N,"background-repeat":"no-repeat"}),b.j5(c)},endSelectMode:function(){this.D5=!1,this.H5(),p(this.sia).css({background:M,"background-repeat":"no-repeat"})},H5:function(){var a=this.a1();a.gv(!0,m,!0),a.repaint()},destroy:function(){var a=this;a.D5&&a.H5(),a.MH=!1,a.W0=-1,a.X0(),a.Y0(),p(a.Z0).remove(),p(a.$0).remove(),p(a._0).remove()},bind:function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(F+" "),p(d).bind(a+F,b,c))},unbind:function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(F+" "),p(c).unbind(a+F,b))},unbindAll:function(){var a=this.qo;a&&p(a).unbind(F)},caret:function(a){var b,c,d=this,e=d.qo;if(e)return b=t.activeElement===e,c=p(e),0===arguments.length?b?d.b1(e).end:c.data("caret-before"):void(a!==d.caret()&&(b?(d.c1(e,a),c.data("caret-before",d.b1(e).end)):c.data("caret-before",a),d.Wq(H,{})))},b1:function(a){var b,c,d,e=this,f=-1,g=-1;return e.d1(a)?(f=a.selectionStart,g=a.selectionEnd):e.Cia(a)&&(b=s.getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),g=(""+d).length,d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.startContainer,c.startOffset),f=(""+d).length,d.detach())),{start:f,end:g}},c1:function(a,b){var c,d,e,f=this;f.d1(a)?a.setSelectionRange(b,b):f.Cia(a)&&(e=this.e1(a,b),e&&(c=s.getSelection(),d=t.createRange(),d.setStart(e.node.firstChild,e.offset),d.collapse(!0),c.removeAllRanges(),c.addRange(d),this.V4&&(a.parentElement.scrollTop=a.parentElement.scrollHeight)))},text:function(a){var b,c,d,e,f,g=this,h=g.qo,i=g.a1();return h&&i&&!i.Js?(b=g.d1(h),c=g.Cia(h),0===arguments.length?(d="",b?d=h.value:c&&(d=y?v.Woa(h):h.innerText,d=d.replace(/\r\n?/g,"\n"),d.indexOf(D)>=0&&(d=v.Ika(d,D," "))),d):(null!==a&&void 0!==a||(a=""),void(a!==g.text()&&(g.S0=g.T0(a),b?h.value=a:c&&(g.V0(g.S0),g.caret(a.length)),e={},f=k.G0.H0,f&&f._text&&(e={sheet:f.kj,editor:f.I0&&f.I0.firstChild.firstChild,canvasOffset:f.f1}),g.Wq(G,e))))):""},autoComplete:function(a){return 0===arguments.length?this.g1:void(this.g1=a)},showHelp:function(a){return 0===arguments.length?this.h1:void(this.h1=a)},add:function(a){var b,c;if(a)if(p.isArray(a))for(b=a.length,c=0;c<b;c++)this.Sb(a[c]);else this.Sb(a)},Sb:function(a){var b,c,d,e,f=a&&a.name&&z(a.name);if(f){for(b=this.i1,c=b.length,d=0;d<c;d++){if(e=z(b[d].name),e===f)return;if(e>f)break}b.splice(d,0,a)}},remove:function(a){var b,c,d;if(a)for(a=z(a),b=this.i1,c=b.length,d=0;d<c;d++)if(z(b[d].name)===a){b.splice(d,1);break}},workbook:function(a){var b=this;return 0===arguments.length?b.OC:void(a===l?b.V4&&b.H5():(b.P0(a),b.j1()))},P0:function(a){var b,c;a&&(b=this,b.OC&&b.Y0(),c=b.qo,c&&(b.OC=a))},l1:function(){var a,b,c,d=[],e=this.S0,f=e&&e.length,g=0,h=0;if(f>0)for(c=0;c<f;c++)a=e[c],b=a.text,11===a.type&&d.push({textOffset:g,text:b,ranges:a.ranges,index:h++,allowDrag:a.allowDrag}),g+=b.length;return d},m1:function(){var a,b,c,d,e,f=this.qo,g=this.l1();if(f&&g&&g.length>0)for(a=this.caret(),b=g.length,e=0;e<b;e++){if(c=g[e],d=c.textOffset,d<a&&a<=d+c.text.length)return c;if(d>=a)break}return l},n1:function(a){var b,c,d;return!!a&&(b=this.caret(),c=a.text,d=a.textOffset,d<b&&b<=d+c.length)},o1:function(a){var b,c,d,e,f,g,h,i=this.l1(),j=i.length;if(a<0||j<=a)return"";for(b=[],d=0,e=0;e<j;e++){for(c=i[e],f=!1,g=0;g<b.length;g++)if(b[g].text.replace(/\s+/g,"").toUpperCase()===c.text.replace(/\s+/g,"").toUpperCase()){f=!0;break}if(f){if(a===e){d=g;break}}else if(b.push(c),a===e){d=b.length-1;break}}return h=L,h[d%h.length]},M0:function(){var a,b,c;return!!this.MH||(!!this.V4||(a=this.s1(this.caret()),!!a&&(b=a.type,c=a.text,1===b||8===b||7===b&&"%"!==c||5===b||9===b||15===b)))},t1:function(a){if(!a||!this.MH)return!1;var b=this.W0,c=this.caret(),d=a.textOffset;return b<=d&&d<c},u1:function(){var a,b,c=[],d=this.l1(),e=d.length;if(e>0)for(b=0;b<e;b++)a=d[b],this.t1(a)&&c.push(a);return c},v1:function(a,b,c){var d,e,f,g,h,i,l,m,n,o,p,q=this,r=q.qo;if(a&&r){if(!q.MH){if(!q.M0())return;b=!1,q.MH=!0,q.W0=q.caret(),q.Wq(I,{})}d=q.W0,e=q.text(),f=q.caret(),e||(e="=",d=q.W0=1,f=1),g=f,c&&(b=!1,e=e.substr(0,d)+e.substr(f),q.S0=q.T0(e),f=d,g=f),h=q.s1(f),b?(i=e.substr(0,f),i=i.substr(0,i.length-h.text.length),i.length>=d&&(h.text=a,g=i.length+a.length)):(l=q.S0,m=j.k.Cb(l,h),n=q.V4&&l.length>1&&m===l.length-1&&11===h.type,f>d||n?(l.splice(m+1,0,{text:this.w1(),type:8}),l.splice(m+2,0,{text:a,type:11}),a=","+a):l.splice(m+1,0,{text:a,type:11}),g=f+a.length),q.z1(),o={},p=k.G0.H0,p&&p._text&&(o={sheet:p.kj,editor:p.I0&&p.I0.firstChild.firstChild,canvasOffset:p.f1}),q.Wq(G,o),q.caret(g)}},NH:function(){var a=this;a.MH&&(a.MH=!1,a.W0=-1,a.Wq(J,{}))},B1:function(){this.MH=!0,this.W0=this.caret()},C1:function(a){return void 0!==a&&(this.W0=a),this.W0},D1:function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.qo;if(l&&!(a<0)&&b){for(d="",e=!1,f=k.S0,g=f&&f.length,i=0,j=0;j<g;j++){if(h=f[j],11===h.type&&i++===a){f[j]={text:b,type:11},e=!0;break}d+=h.text}e&&(k.z1(),k.Wq(G,{}),c?k.caret(k.text().length):k.caret(d.length+b.length))}},j1:function(){var a,b,c,d=this;d.OC&&(a=d.qo,d.OC&&a&&(b=g.Events,a.setAttribute(B,"gcAttachedFormulaTextBox"),d.V4||(d.OC.CF=d),d.OC.Fu(b.FormulatextboxEditStarted,d,d.E1),d.OC.Fu(b.FormulatextboxEnterCell,d,d.F1),d.OC.Fu(b.FormulatextboxEditEnded,d,d.G1),d.OC.Fu(b.FormulatextboxActiveSheetChanged,d,d.H1),d.OC.Fu(b.FormulatextboxRangeChanged,d,d.I1),d.OC.Fu(b.FormulaTextBoxTextChanged,d,d.J1),d.OC.Fu(b.FormulaTextBoxCaretChanged,d,d.K1),c=P(d.OC),c&&!d.V4&&d.text(d.L1(c,c.Jl,c.Kl)),d.Fu(G,d,d.M1),d.Fu(H,d,d.N1)))},refresh:function(){var a,b=this.OC;b&&(a=P(b),a&&!this.V4&&this.text(this.L1(a,a.Jl,a.Kl)))},Y0:function(){var a,b=this,c=b.OC;!b.O0&&c&&(a=g.Events,b.V4||(c.CF=null,c.Gu(a.FormulatextboxEditStarted,b.E1),c.Gu(a.FormulatextboxEnterCell,b.F1),c.Gu(a.FormulatextboxEditEnded,b.G1),c.Gu(a.FormulatextboxActiveSheetChanged,b.H1),c.Gu(a.FormulatextboxRangeChanged,b.I1),c.Gu(a.FormulaTextBoxTextChanged,b.J1),c.Gu(a.FormulaTextBoxCaretChanged,b.K1),b.Gu(G,b.M1),b.Gu(H,b.N1)),b.text("")),b.OC=null},O1:function(){var a,b,c=this;c.OG||(c.OG=!0,a=this.OC,b=a&&P(a),b&&!b.isEditing()?(c.V4||b.EF(null,b.Jl,b.Kl,null,null,!1,null),c.Q1=!0):c.Q1=!1,c.OG=!1,c.R1||c.S1())},UF:function(){var a,b,c,d,e,f,g=this,h=g.OC,i=h&&P(h);i&&(a=i.Cw,g.Q1&&a&&(b=a.text(),c=g.text(),c!==b&&(d=g.caret(),e=i.getFormulaInformation(i.getActiveRowIndex(),i.getActiveColumnIndex()),g.text(b),e.isArrayFormula&&(d>=c.length&&(d-=1),d=n(0,d-1)),g.caret(d))),f=i.Px,2!==f&&(i.Px=2,i.Cu(f,2)))},L1:function(a,b,c){var d,e,f,g,h,i="";return a&&(d=a.parent,e=d&&d.options,f=a.getFormulaInformation(b,c),f&&f.hasFormula?(i="="+f.formulaWithCulture,f.isArrayFormula&&(i="{"+i+"}")):(g=a.getActualStyle(b,c),h=a.getValue(b,c),i="string"==typeof h&&g.quotePrefix||i.length>0&&"="===i[0]&&e&&e.allowUserEditFormula?"'"+h:v.Il(g,h,a)||"")),i},H1:function(a,b){var c,d,e=a.data;e.OG||(c=b.newSheet,e.V4||(e.OG=!0,e.close(),b&&(d=c,e.text(e.L1(d,d.Jl,d.Kl))),e.OG=!1))},E1:function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&P(b),d=c&&c.Cw,d&&e.V4===d.V4&&e.C5===d.C5&&(e.OG=!0,e.text(d.text()),e.OG=!1))},F1:function(a,b){var c=a.data;c.V4||c.OG||(c.OG=!0,b&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1)},I1:function(a,b){var c,d,e,f,h,i=a.data;i.OG||i.V4||(i.OG=!0,b&&(c=b.sheet,d=b.row,e=b.col,f=b.rowCount,h=b.colCount,new g.Range(d,e,f,h).contains(c.Jl,c.Kl)&&i.text(i.L1(c,c.Jl,c.Kl))),i.OG=!1)},G1:function(a,b){var c=a.data;return c.V4&&c.D5&&c.E5?void(b.ignore=!0):void(c.OG||(c.OG=!0,c.close(),b&&b.sheet.Cw&&!b.sheet.Cw.V4&&!c.V4&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1))},J1:function(a,b){var c,d=a.data;d.OG||(!b.sheet.Cw||d.V4===b.sheet.Cw.V4&&d.C5===b.sheet.Cw.C5)&&(d.OG=!0,b&&(c=d.caret(),d.text(b.text),d.caret(c)),d.OG=!1)},K1:function(a,b){var c=a.data;c.OG||(!b.sheet.Cw||c.V4===b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5)&&(c.OG=!0,b&&c.caret(b.caret),c.OG=!1)},M1:function(a){var b,c,d,e,f,g,h,i,j=a.data;if(!j.OG&&(b=j.OC,c=b&&P(b))){if(c.isEditing()||(j.O1(),j.focus()),j.OG=!0,d=c.Jl,e=c.Kl,f=c.Cw,g=c.getCellType(d,e),f){if(j.V4!==f.V4||j.C5!==f.C5)return;h=f.caret(),f.text(j.text()),f.caret(h)}else i={sheet:c,row:d,col:e,sheetArea:3},g.setEditorValue(c.BF,j.text(),i);j.OG=!1}},N1:function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&P(b),c&&c.isEditing()&&(d=c.Cw,(!d||e.V4===d.V4&&e.C5===d.C5)&&(e.OG=!0,d&&(d.caret(e.caret()),e.S1()),e.OG=!1)))},ad:function(a){var b,c,d,e=this;e.T1=!1,e.U1=!1,e.MH=!1,e.W0=-1,e.i1=[],e.g1=!0,e.h1=!0,e.V1=!0,b=r("div"),b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute(B,"gcFuncACPopup"),a.insertBefore(b,l),e.Z0=b,e.R1=!1,c=r("div"),c.className="gcsj-func-help-popup",c.style.display="none",c.setAttribute(B,"gcFuncHelpPopup"),a.insertBefore(c,l),e.$0=c,e.W1=!1,p(b).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),p(c).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),p(b).bind("scroll",function(){e.X1&&clearTimeout(e.X1),e.X1=setTimeout(function(){e.qo&&e.qo.focus()},100)}),d=r("div"),d.style.display="none",d.setAttribute(B,"gcFuncHelpDiv"),a.insertBefore(d,l),e._0=d,e.OC=null,e.OG=!1,e.Q1=!1,e.O0=!1},N0:function(a){var b,c,d;a&&(b=this,c=b.Cia(a),(b.d1(a)||c)&&(d=p(a),b.qo&&b.X0(),b.qo=a,x&&x.msie?c||y?(b.Fu("focus",function(){d.data("text-before",b.text())}),b.Fu("click",function(){d.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(a){b.Fu(a,function(){b.Y1()})})):b.Fu(C,function(){b.Z1()}):b.Fu(C,function(){if(c){var a=b.qo.lastChild;x.chrome&&a&&"BR"===a.tagName&&b.qo.removeChild(a)}b.Z1()}),b.Fu("keydown",function(a){var d,e,f,g=a.ctrlKey,h=a.shiftKey,i=a.altKey,j=a.metaKey,k=g||h||i||j,l=a.keyCode;b.U1=!1,!k&&b.R1&&(l===K.down?(b._1(1),w(a)):l===K.up?(b._1(-1),w(a)):l===K.tab&&(b.a2(),w(a))),l===K.esc&&b.close(),b.b2(a),d=P(b.OC),e=d.mm.LH(a),b.V4&&e&&(f=d.Cw,f&&f.MH&&f.NH()),c&&(e?b.Jka():13===l&&(g||i)&&b.Jka(!0),c&&g&&(90===l||89===l)&&w(a))}),b.Fu("keyup",function(a){var d,e,f,g;b.b2(a),d=b.text(),c&&(f=a.keyCode,g=a.ctrlKey,g&&90===f?(e=b.Ac.pop()||"",b.text(e),b.Bc.push(d)):g&&89===f&&(e=b.Bc.pop(),e&&(b.text(e),b.Ac.push(d))))}),b.Fu("focus",function(a){var c=x&&x.mozilla;c&&!b.qo.innerText&&(b.qo.innerText=""),b.b2(a),b.V4&&b.D5&&(b.E5=!0,b.j5())}),b.Fu("blur",function(){b.V1&&b.close(),b.V4&&(b.H5(),b.E5=!1)}),b.Fu("mousedown",function(){b.E5=!0,b.O1()}),b.Fu("mouseup",function(){b.UF()}),b.Fu("click",function(a){var c,d,e;b.MH&&b.NH(),c=b.OC,d=c&&P(c),e=d&&d.Cw,e&&e.MH&&!e.V4&&e.NH(),b.b2(a)}),b.Fu("compositionstart",function(){b.T1=!0}),b.Fu("compositionend",function(){b.T1=!1,(x.edge||x.chrome)&&b.Y1()})))},X0:function(){var a,b=this,c=b.qo;c&&(a=p(c),a.removeData("text-before"),a.removeData("caret-before"),b.nu(),b.unbindAll(),b.V4&&(p(b.cga).empty(),b.cga=l),b.qo=l)},Y1:function(){var a=this,b=p(a.qo),c=a.text();b.data("text-before")!==c&&(a.T1||b.data("text-before",c),a.Z1())},b2:function(a){if(x&&x.msie){var b=function(a,b){return function(){a.d2(a,b)}};setTimeout(b(this,a),10)}else this.d2(this,a)},d2:function(a,b){var c,d,e,f,g,h=b.keyCode,i=h===K.left||h===K.right||h===K.home||h===K.end||h===K.pdn||h===K.pup||h===K.tab||h===K.enter;if(a.g1||(i=i||h===K.up||h===K.down),c=void 0!==b.button,i||c){if(d=a.qo,e=p(d),f=a.b1(d),f.start!==f.end)return;g=f.end,e.data("caret-before")!==g&&(e.data("caret-before",g),a.Wq(H,{}),a.S1())}},e2:function(){return this.OC?P(this.OC).Jl:m},f2:function(){return this.OC?P(this.OC).Kl:m},a1:function(){if(this.OC)return P(this.OC)},T0:function(a){var b,c,d=this,e=[];return a&&"="===a[0]?(b=new h.Parser,c=b.parseReferenceExpressionInfos(a,d.a1(),d.e2(),d.f2(),!0),e=d.i2(c)):(e.push({text:a,type:17}),e)},Z1:function(){var a,b,c,d=this,e=d.text();"\n"!==e&&e.indexOf("\n")>=0||(a=d.qo,b=p(a),d.U1=!0,d.S0=d.T0(e),d.Cia(a)?d.T1||("\n"===e?(b.empty(),d.Wq(G,{type:C})):(c=d.caret(),d.V0(d.S0),d.Wq(G,{type:C}),d.caret(c))):d.Wq(G,{type:C}),c=d.caret(),b.data("caret-before")!==c&&(b.data("caret-before",c),d.Wq(H,{})),d.c2(),d.R1||d.S1())},j2:function(){return j.CultureManager.q4().NumberFormat},h2:function(){var a=this.j2();return a&&a.arrayGroupSeperator||";"},l2:function(){var a=this.j2();return a&&a.arrayListSeparator||","},w1:function(){var a=this.j2();return a&&a.listSeparator||","},g2:function(){var a=this.j2();return a&&a.numberDecimalSeparator||"."},i2:function(a){var b,c,d,e,f=[],g=[],h=this.h2(),i=this.w1(),k=this.l2(),l=!1;for(b=0;b<a.length;b++)b>0&&b<a.length-1&&";"===a[b-1].text&&","===a[b].text&&"ARRAYROW"===a[b+1].text||(c=a[b],d=this.m2(c,g),e=c.text,2===d?f.push({text:e,type:d}):l&&8===d&&","===e?f.push({text:k,type:9}):l&&8===d&&";"===e?f.push({text:h,type:10}):8===d?f.push({text:i,type:d}):3===d?("ARRAY"===e&&(l=!0),f.push({text:"{",type:3})):4===d?"ARRAY"===e?(l=!1,f.push({text:"}",type:4})):f.push({text:e,type:4}):6===d?f.push({text:")",type:d}):13===d?f.push({text:j.o.nb(e),type:d,ranges:c.ranges,allowDrag:c.canDrag}):null!==d&&f.push({text:e,type:d,ranges:c.ranges,allowDrag:c.canDrag}));return f},m2:function(a,b){var c,d=a.type,e=a.subType,f=a.text,g=a.value;if(1===d){if(1===e)return"ARRAY"===f||"ARRAYROW"===f?(b.push(3),3):(b.push(5),"("===g.trim()?5:2);if(2===e){if(")"===g.trim())return 6;if(b.length>0){if(c=b[b.length-1],3===c)return b.pop(),4;if(5===c)return b.pop(),6}}if("="===g.trim())return 1}else if(3===d){if(0===e)return 8}else{if(5===d||6===d||4===d)return 7;if(0===d)return 7===e||0===e?11:5===e?12:4===e?13:3===e?14:6===e?16:14;if(7===d)return 15;if(8===d)return 17}return 17},z1:function(){var a,b=this,c=b.qo,d=b.S0,e="",f=d&&d.length;for(a=0;a<f;a++)e+=d[a].text;b.d1(c)?c.value=e:b.Cia(c)&&b.V0(d)},d1:function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},Cia:function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},Dia:function(a){return"gcEditingInput"===p(a).attr(B)},bW:function(a){return a&&"="===a[0]},Fu:function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(E+" "),p(d).bind(a+E,b,c))},Gu:function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(E+" "),p(c).unbind(a+E,b))},nu:function(){var a=this.qo;a&&p(a).unbind(E)},Wq:function(a,b){var c=this.qo;c&&p(c).trigger(a,b)},s1:function(a){var b,c,d,e,f;if(a<=0)return l;if(b=this.S0,c=b&&b.length,c>0)for(d=0,f=0;f<c;f++)if(e=b[f],d+=e.text.length,d>=a)return e;return l},n2:function(){var a,b,c=this.OC,d=c&&P(c),e=d&&d.Cw;if(e){for(a=e.i1,b=0;b<a.length;b++)a[b].isFunc=!0;return a.concat(this.o2(c,d)).concat(this.q2(d))}return this.i1},o2:function(a,b){var c,d=[],e=b.getCustomNames();return e&&p.each(e,function(a,b){d.push({name:b.Cj,description:b.kT})}),c=a.getCustomNames(),c&&p.each(c,function(a,b){d.push({name:b.Cj,description:b.kT})}),d},q2:function(a){var b,c,d=[],e=a.tables;if(e&&(b=e.all()))for(c=0;c<b.length;c++)d.push({name:b[c].name(),description:O().Fbx_TableName_Description+b[c].name()});return d},s2:function(a,b){var c,d,e,f;for(a=z(a),u.Bb(a,"[")&&(a=a.substr(a.lastIndexOf("[")+1),a=u.Gb(a,"@","")),c=[],d=b&&b.length,f=0;f<d;f++)e=b[f],0===z(e.name).indexOf(a)&&c.push(e);return c},t2:function(){var a,b,c,d,e,f=this.caret();if(f<=0)return"";if(a=this.S0,b=a&&a.length,b>0)for(c=0,e=0;e<b;e++){if(d=a[e],c+d.text.length>=f)return d.text.substring(0,f-c);c+=d.text.length}return""},u2:function(){var a,b,c,d,e,f,g,h,i,j=this.caret(),k=this.S0,m=k&&k.length,n=[],o=0;for(b=0;b<m;b++){if(a=k[b],n.push(a),6===a.type)for(c=0;n.length>0;)if(d=n.pop(),6===d.type&&c++,5===d.type&&c--,0===c){n.length>0&&(d=n[n.length-1],d&&2===d.type&&n.pop());break}if(o+=a.text.length,o>=j)break}if(n.length>0)for(e=0;n.length>0;)if(a=n.pop(),8===a.type)e++;else if(2===a.type){for(f=z(a.text),g=this.n2(),h=g&&g.length,b=0;b<h;b++)if(i=g[b],z(i.name)===f)return{func:i,activeParamterIndex:e,isFunc:i.isFunc};break}return l},c2:function(){var a,b,c,d,e,f,g,h,i=this,j=i.v2(),k=i.g1&&i.bW(i.text())&&j&&j.length>0&&!i.MH&&!i.T1;if(k&&!i.V4){for(i.w2(),a=i.Z0,j.length>8?(a.style.height="204px",a.style.overflowY="scroll"):(a.style.height="auto",a.style.overflowY=""),b="",c=j.length,e=0;e<c;e++)d=j[e],b+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+d.isFunc+">"+d.name+"</div><div class='gcsj-func-ac-row-description'>"+(d.description||"")+"</div></div>";f=p(i.Z0),f.html(b).show(),i.R1=!0,g=f.find(".gcsj-func-ac-row"),g.length>0&&(h="gcsj-ac-row-active",p(g[0]).addClass(h),g.bind("mouseover",function(){g.removeClass(h),p(this).addClass(h)}),g.bind("click",function(){i.a2()})),i.SH()}else i.z2()},v2:function(){var a,b,c=this,d=c.s1(c.caret()),e=d&&d.text,f=[],g=c.S0.indexOf(d);if(d&&14===d.type)return f;if(a=c.A2(g),a.length>0){if(f=f.concat(a).concat(O().B2),u.jb(e,"[")||u.jb(e,"[@"))return f}else f=this.n2();return e=c.t2(),b=[],e&&(b=c.s2(e,f)),b},A2:function(a){var b,c,d,e,f,g,h,i,j=[],k=this.S0,m=k&&k.length;if(a<0||a>=k.length)return j;if(b=this.OC,c=b&&P(b),d={},void 0!==a&&a!==l||(a=m),c&&(e=k[a],f=c.tables,g=f&&f.findByName(u.Ib(e.text,"[")),void 0!==g&&g!==l&&!d[g])){for(d[g]=!0,h=0,i="";i!==l;)i=g.getColumnName(h++),i!==l&&j.push({name:i,description:""});if(j.length>0)return j}return j},z2:function(){p(this.Z0).hide(),this.R1=!1},_1:function(a){var b,c,d,e,f,g,h=p(this.Z0).find(".gcsj-func-ac-row"),i=h.length;if(0!==i){if(b="gcsj-ac-row-active",c=0,a)for(d=0;d<i;d++)if(p(h[d]).hasClass(b)){c=d+a;break}e=p(this.Z0).scrollTop(),h.removeClass(b),f=0,i>0&&(f=h[0].offsetHeight),c=n(c,0),c=o(c,i-1),g=h[c],p(g).addClass(b),g.offsetTop+g.offsetHeight>p(this.Z0).scrollTop()+p(this.Z0).height()?p(this.Z0).scrollTop(p(this.Z0).scrollTop()+f):g.offsetTop<p(this.Z0).scrollTop()?p(this.Z0).scrollTop(g.offsetTop):p(this.Z0).scrollTop(e)}},a2:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,o=this,q=p(o.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),r=q.text(),s="true"===q.attr("isFunc");if(r){for(a=o.caret(),b=o.S0,c=b&&b.length,d=0,e=0,f=0,g=l;f<c&&(g=b[f],e=g.text.length,!(d+e>=a));)f++,d+=e;h=a-d,i=g.text,j=0,k=0,u.Bb(i,"[")?(j=i.lastIndexOf("[",h-1),j===-1?(j=i.indexOf("["),j===-1?g.text=r:g.text=r+i.substr(j),j=0):(j++,"@"===i.charAt(j)&&(j+=1),k=i.indexOf("]",h),k===-1&&(k=i.length),g.text=i.substring(0,j)+r+i.substr(k))):g.text=r,s?g.type=2:g.type=11,m=f+1,n=b[m],!s||n&&5===n.type||b.splice(m,0,{text:"(",type:5}),o.z2(),o.qo.focus(),o.z1(),o.caret(d+r.length+j+(s?1:0)),o.S1(),o.S0=o.T0(o.text()),o.Wq(G,{})}},S1:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,q,r,s,t,u=this;if(u.R1&&u.z2(),a=u.u2(),a===l||a.isFunc!==!0)return void u.w2();if(b=u.w1(),c=u.h1&&u.bW(u.text())&&a&&!u.MH&&!u.T1,c&&!u.V4){for(d=a.func,e=d.parameters,f=e&&e.length,g=o(f-1,a.activeParamterIndex),i="",j=0;j<f;j++)h=e[j],k=h.name,h.repeatable&&(k+=b+"..."),h.optional&&(k="["+k+"]"),m=j===f-1?"":b+" ",k=j===g?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+k+"</span>"+m:"<span class='gcsj-func-help-paramter'>"+k+"</span>"+m,i+=k;n="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+d.name+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+i+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",q="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+O().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(d.description||"")+"</div></div>",r="<div class='gcsj-func-help-section-content'>"+q+"</div>",s="<div class='gcsj-func-help-body'>"+r+"</div>",t=n+s,p(u.$0).html(t).show(),u.W1=!0,u.SH()}else u.w2()},w2:function(){p(this.$0).hide(),this.W1=!1},close:function(){this.z2(),this.w2()},BH:function(a,b){var c,d,e,f,g,h;return!this.MH&&(c=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey,h=a.srcElement||a.target,h&&b&&b.isEditing&&"gcAttachedFormulaTextBox"===h.getAttribute("gcUIElement")?67===d&&(e||g)&&!f||88===d&&(e||g)&&!f:this.R1&&!c&&(d===K.down||d===K.up||d===K.tab))},SH:function(){var a,b,c,d,e,f,g,h,i,j,m,n,o,q,r,s=this,u=l;if(s.R1?u=s.Z0:s.W1&&(u=s.$0),u){if(a=p(s.qo),b=p(u),c=k.G0.H0,c&&c.kj)return d=c.kj.getCellRect(c.nT,c.Mk),e=c.f1,void b.css("top",d.y+d.height+e.top).css("left",d.x+e.left);f=a.parent(),g=a.outerHeight(),s.Dia(s.qo)&&(f=f.parent(),g=f.outerHeight()),h=f.css("top"),i=parseFloat(h),isNaN(i)||(h=i),j=f.css("left"),"auto"===h&&(h=a.offset().top,j=a.offset().left),m=h+g,n=p(t.body).outerHeight(),o=b.outerHeight(),q=m+o,q>n&&(r=h-o,r>=0&&(m=r)),b.css("top",m).css("left",j)}},focus:function(){p(this.qo).focus()},V0:function(a){var b,c,d,e,f=this,g="",h="",i=a&&a.length,j=0;for(c=0;c<i;c++)b=a[c],d="",11===b.type&&(d=" style='color: "+f.o1(j++)+"'"),f._0.innerText=b.text,g+="<span"+d+" class='gcsj-func-color-text'>"+f._0.innerHTML+"</span>",h+=b.text;if(h||f.text())if(e=f.qo,g)e.innerHTML="<span class='gcsj-func-color-content'>"+g+"</span>";else for(;e.firstChild;)e.removeChild(e.firstChild)},e1:function(a,b){var c,d,e,f=p(a).find(".gcsj-func-color-content .gcsj-func-color-text"),g=f.length;for(b=n(0,b),e=0;e<g;e++)if(c=f[e],d=c.innerText,b-=d.length,b<=0)return{node:c,offset:d.length+b};return d?{node:c,offset:d.length}:l},Jka:function(a){var b=this,c=b.qo,d=b.Cia(c),e=b.text();d&&e&&(e=a?e.substr(0,e.length-2):e,b.Ac.push(e))}},b}(),k.FormulaTextBox=f,a.exports=k}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.CalcEngine},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var a=c(2),b=c(3),d=a.CalcEngine,e=c(1),f=a.kf,g=a.GC$,h=g.extend,i=null,j=void 0,k=Math.max,l=Math.min,m=e.L0,n=e.C2;h(a.iI.prototype,{D2:function(a){var b,c,d,e,g,h,i,k,l,m,o,p,q,r,s,t,u=this,v=u.kj,w=v.Cw;w&&(u.Kka(),b=v.frozenRowCount(),c=v.frozenColumnCount(),d=w.MH,d&&u.E2||(u.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),e=v.getRowCount(),g=v.getColumnCount(),h=a.hitTestType,i=a.row,k=a.col,l=u.shift,m=u.ctrl,o=u.E2,p=o.anchorRow,q=o.anchorCol,r=-1,s=-1,0===h?(r=b?v.ar():v.lq,s=c?v.$q():v.qq,t=f(-1,-1,-1,-1),w.v1(n(v,t),l,!m),u.OG=!0):1===h?(r=b?v.ar():v.lq,s=k,t=v.Jx(0,k,e-1,k,!0),l&&q>=0&&(t=v.Jx(0,k,e-1,q,!0)),t=f(-1,t.col,-1,t.colCount),w.v1(n(v,t),l,!m),u.OG=!0):2===h?(r=i,s=c?v.$q():v.qq,t=v.Jx(i,0,i,g-1,!0),l&&p>=0&&(t=v.Jx(i,0,p,g-1,!0)),t=f(t.row,-1,t.rowCount,-1),w.v1(n(v,t),l,!m),u.OG=!0):3===h&&(r=i,s=k,i!==j&&k!==j&&(t=v.Jx(i,k,i,k,!0),t=f(t.row,t.col,1,1),l&&p>=0&&q>=0&&(t=v.Jx(i,k,p,q,!0)),w.v1(n(v,t),l,!m)),u.OG=!0),u.DG=u.OG,l&&d||(o.anchorRow=r,o.anchorCol=s,o.leadingRow=r,o.leadingCol=s),u.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},u.qG())},F2:function(b){var c,d,f=!1,g=e.G0.H0;if(g&&g.I0)if(c=g.kj,d=b.Cw,d&&c.setFormula(g.nT,g.Mk,d.text()),c!==b){if(a.Commands.Wx.G2(c),!c.endEdit())return;f=!0}else d&&(d.destroy(),b.Cw=i),g.$b();return f},EG:function(){var a,b=this,c=b.rG;c&&b.OG&&(a=c.sG,3===a?b.H2():2===a?b.I2():1===a&&b.J2())},H2:function(){var a,b,c,d,e=this,f=e.E2,g=f.anchorRow,h=f.anchorCol,i=e.fH(),j=e.gH();g>=0&&h>=0&&i>=0&&j>=0&&(a=e.kj,b=a.Jx(i,j,g,h,!0),c=n(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},I2:function(){var a,b,c,d,e=this,g=e.E2.anchorRow,h=e.fH();g>=0&&h>=0&&(a=e.kj,b=a.Jx(h,0,g,a.getColumnCount()-1,!0),b=f(b.row,-1,b.rowCount,-1),c=n(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},J2:function(){var a,b,c,d,e=this,g=e.E2.anchorCol,h=e.gH();g>=0&&h>=0&&(a=e.kj,b=a.Jx(0,h,a.getRowCount()-1,g,!0),b=f(-1,b.col,-1,b.colCount),c=n(a,b),c&&(d=a.Cw,d.v1(c,!0,!1))),e.NG()},yH:function(){var a=this;a.RG(),a.rG=i,a.OG=!1,a.DG=!1},iG:function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kj,l=j._oa(),n=a.formulaRangeHitInfo;
n&&n.inBorder&&l&&(l.MH&&l.NH(),l.close(),b=n.paramRange,c=b&&b.text,c&&(d=m(k,c),d&&(j.Kka(),e=k.Tq(d),f=a.row,g=a.col,f<e.row&&(f=e.row),f>=e.row+e.rowCount&&(f=e.row+e.rowCount-1),g<e.col&&(g=e.col),g>=e.col+e.colCount&&(g=e.col+e.colCount-1),h=f-e.row,i=g-e.col,j.OG=!0,j.FG=!0,j.K2={paramRange:b,fromRange:d,rowOffset:h,colOffset:i},j.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},j.qG())))},GG:function(){var a,b,c,d,e,g,h,i,j,m,o,p,q,r,s,t,u,v,w,x,y,z=this;z.OG&&z.FG&&(a=z.fH(),b=z.gH(),a>=0&&b>=0&&(c=z.K2,d=c.fromRange,e=c.rowOffset,g=c.colOffset,h=c.toRow,i=c.toCol,j=a,m=b,j===h&&m===i||(c.toRow=j,c.toCol=m,o=z.kj,p=o.getRowCount(),q=o.getColumnCount(),r=d.row,s=d.col,t=d.rowCount,u=d.colCount,v=r<0?-1:k(0,l(p-t,a-e)),w=s<0?-1:k(0,l(q-u,b-g)),x=n(o,f(v,w,t,u)),x&&(y=z._oa(),y.D1(c.paramRange.index,x,!0)))),z.NG())},zH:function(){var a,b=this;b.RG(),b.OG=!1,b.FG=!1,b.K2=i,a=b._oa(),a.onRangeMoved&&a.onRangeMoved()},jG:function(a){var b,c,d,e,f,g,h,i,j,k,l,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;if(q&&p&&(p.MH&&p.NH(),b=q.paramRange,c=b&&b.text,b&&c&&(d=m(o,c)))){if(n.Kka(),e=d.row,f=d.row<0?-1:d.row+d.rowCount-1,g=d.col,h=d.col<0?-1:d.col+d.colCount-1,q.inTopLeft)i=f,j=h,k=e,l=g;else if(q.inTopRight)i=f,j=g,k=e,l=h;else if(q.inBottomLeft)i=e,j=h,k=f,l=g;else{if(!q.inBottomRight)return;i=e,j=g,k=f,l=h}n.OG=!0,n.HG=!0,n.L2={paramRange:b,anchorRow:i,anchorCol:j,toRow:k,toCol:l},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG()}},kG:function(a,b){var c=a.Cw;return c&&c.M0()?(this.D2(b),!0):!!this.F2(a)},IG:function(){var a,b,c,d,e,g,h,i,j,m,o,p,q,r,s,t,u,v,w,x,y=this;y.OG&&y.HG&&(a=y.fH(),b=y.gH(),a>=0&&b>=0&&(c=y.L2,d=c.anchorRow,e=c.anchorCol,g=c.toRow,h=c.toCol,i=a,j=b,i===g&&j===h||(c.toRow=i,c.toCol=j,m=y.kj,o=m.getRowCount(),p=m.getColumnCount(),q=d<0?o-1:d,r=e<0?p-1:e,s=l(q,i),t=l(r,j),u=k(q,i)-s+1,v=k(r,j)-t+1,0===s&&u===o&&(s=-1,u=-1),0===t&&v===p&&(t=-1,v=-1),w=n(m,f(s,t,u,v)),w&&(x=y._oa(),x.D1(c.paramRange.index,w,!0)))),y.NG())},AH:function(){var a,b,c=this;c.RG(),c.OG=!1,c.HG=!1,c.L2=i,a=c._oa(),a.V4&&(a.W0=1,b=a.text().lastIndexOf(",",a.caret()),b!==-1&&(a.W0=b+1)),a.onRangeResized&&a.onRangeResized()},vr:function(a,b,c){var d,f,g,h,j,k,l,n,o,p,q,r,s=this.kj,t=this._oa(),u=t&&t.l1();if(!u||0===u.length||!t.UQa)return i;if(d=a.rowViewportIndex,f=a.colViewportIndex,this.qH(d,f,b,c))return i;for(k=u.length-1;k>=0;k--)if(g=u[k],g.allowDrag!==!1&&(l=e.G0.H0,(!l||!l._text)&&(h=m(s,g.text)))){if(j=s.getRangeRect(d,f,h),n=5,o=j.x-2,p=j.x+j.width+1-n,q=j.y-2,r=j.y+j.height+1-n,o+n<=b&&b<p&&(q+1<=c&&c<=q+3||r+1<=c&&c<=r+3))return{paramRange:g,inBorder:!0};if(q+n<=c&&c<r&&(o+1<=b&&b<=o+3||p+1<=b&&b<=p+3))return{paramRange:g,inBorder:!0};if(p<=b&&b<p+n&&r<=c&&c<r+n)return{paramRange:g,inBottomRight:!0};if(o<=b&&b<o+n&&r<=c&&c<r+n)return{paramRange:g,inBottomLeft:!0};if(p<=b&&b<p+n&&q<=c&&c<q+n)return{paramRange:g,inTopRight:!0};if(o<=b&&b<o+n&&q<=c&&c<q+n)return{paramRange:g,inTopLeft:!0}}return i},_oa:function(){var a=this.kj;return a.Cw||a.Cva},ly:function(){var a,c,e,f,g,h,j,k,l,m,n,o,p,q=this,r=q.kj,s=r.Cw;if(s)if(a=r.Jl,c=r.Kl,e=r.parent,f=e&&1===e.options.referenceStyle,g=new d.SheetParserContext(r,f,b.pf(a,c)),h=new b.Parser,s.MH)for(l=s.u1(),m=0;m<l.length;m++){j=l[m];try{k=h.parse(g,j.text)}catch(a){k=i}k&&1===k.type&&(q.M2(k,a,c,!0,!0),s.D1(j.index,h.unparse(g,k)))}else{if(j=s.m1(),!j)return;try{k=h.parse(g,j.text)}catch(a){k=i}if(!k)return;1!==k.type||k.sf()?1===k.type&&(q.N2(k,a,c),s.D1(j.index,h.unparse(g,k))):(n=j.textOffset+j.text.lastIndexOf(":"),o=s.caret()<=n,o?(q.M2(k,a,c,!0,!1),p=h.unparse(g,k),s.D1(j.index,p),s.caret(j.textOffset+p.lastIndexOf(":"))):(q.M2(k,a,c,!1,!0),s.D1(j.index,h.unparse(g,k))))}},M2:function(a,b,c,d,e){var f,g,h=a.rowRelative,i=a.columnRelative;d&&(h&&i?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):h?(a.columnRelative=!0,a.column-=c):i?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)),f=a.endRowRelative,g=a.endColumnRelative,e&&(f&&g?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):f?(a.endColumnRelative=!0,a.endColumn-=c):g?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},N2:function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)},Kka:function(){var a,b=this.kj,c=b.Cw;c&&(a=c.qo,a&&c.Cia(a)&&c.Jka())}})}()},function(a,b,c){!function(){"use strict";var a,b=c(2),d=c(1),e=void 0,f=b.Commands,g=b.kf,h=d.C2,i=d.L0,j=d.K0,k=c(4),l=k.j.Fa;function m(a){var b,c=a.Cw,d=a.mm;return b=c.MH?d.E2:d.E2={anchorRow:a.Jl,anchorCol:a.Kl,leadingRow:a.Qr,leadingCol:a.Rr}}function n(a,b,c,d,e){var f,i,j,k,n,o,p,q,r,s,t,u,v=a.Cw,w=a.parent,x=w&&w.options;if(v&&v.M0()&&x&&x.allowUserEditFormula&&x.enableFormulaTextbox){switch(f=m(a),i=f.anchorRow,j=f.anchorCol,k=f.leadingRow,n=f.leadingCol,l(d)&&(d=i),l(e)&&(e=j),o=a.mm,b){case 3:t=a.iy(d,e,c,k);break;case 4:t=a.hy(d,e,c,k);break;case 1:t=a.HJ(d,e,c,n);break;case 2:t=a.LJ(d,e,c,n);break;case 5:t=a.OJ();break;case 6:t=a.NJ()}t&&(p=t.row,q=t.col,r=t.leadingCellRow?t.leadingCellRow:p,s=t.leadingCellCol?t.leadingCellCol:q,a.IJ(p,q)&&(f.anchorRow=p,f.anchorCol=q,f.leadingRow=r,f.leadingCol=s,u=h(o.kj,g(p,q,1,1)),u&&v.v1(u,!1,!0),p>=0&&q>=0&&a.Yq(p,q)))}}function o(b,c){if(b){if(2===b.Px)return!1;var d=b.Cw;return d&&d.M0()?(n(b,c,!1),!0):(d&&(b=a.O2(b)),b.yx(c,!1),!0)}return!1}function p(b,c,d,e){if(b){if(2===b.Px)return!1;var f=b.Cw;return f&&f.M0()?(n(b,c,!1,d,e),!0):(f&&(b=a.O2(b)),b.yx(c,!1,d,e),!0)}return!1}function q(a,b,c){var d,e,f,j,k,l,n,o,p=a.Cw,q=a.parent,r=q&&q.options;p&&p.M0()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(d=a.mm,e=m(a),f=e.anchorRow,j=e.anchorCol,p.MH?(l=p.m1(),k=i(a,l.text)):k=g(f,j,1,1),k&&(n=a.UJ(k,b,c,f,j),o=h(d.kj,n),o&&p.v1(o,!0,!1)))}function r(b,c,d){if(b){if(2===b.Px)return!1;var e=b.Cw;return e&&e.M0()?(q(b,c,d),!0):(e&&(b=a.O2(b)),!!b.endEdit()&&(b.Sx(c,d),!0))}return!1}f.Ox=o,f.Qx=p,f.Rx=r,a=function(){function a(){}return a.fv=function(b){return a.O2(b)},a.Xx=function(b){return a.O2(b)},a.Yx=function(b){return a.O2(b)},a.O2=function(b){var c=b,e=d.G0.H0;return e&&e._text&&(c=e.kj,a.G2(c)),c},a.G2=function(a,b){var c,e;void 0===b&&(b=!0),c=a.parent,e=d.G0.H0,e&&e._text&&c.hw(a,b)},a.Zx=function(b,c,d){var e,f,i=!1,j=b.Cw;return j&&j.M0()?(e=m(b),e.anchorRow=c,e.leadingRow=c,f=h(b,g(e.anchorRow,e.anchorCol,1,1)),f&&j.v1(f,!1,!0),b.mq(d),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a._x=function(b,c,d){var e,f,i=!1,j=b.Cw;return j&&j.M0()?(e=m(b),e.anchorRow=c,e.leadingRow=c,f=h(b,g(e.anchorRow,e.anchorCol,1,1)),f&&j.v1(f,!1,!0),b.mq(d),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a.ay=function(b){var c=!1,d=b.Cw,e=b.Jl,f=b.Kl;return d&&d.M0()?(d.MH||(b.mm.E2={anchorRow:e,anchorCol:f,leadingRow:b.Qr,leadingCol:b.Rr}),n(b,5,!1,e,f),c=!0):d&&(b=a.O2(b)),{sheet:b,r:c}},a.by=function(b){var c=!1,d=b.Cw,e=b.Jl,f=b.Kl;return d&&d.M0()?(d.MH||(b.mm.E2={anchorRow:e,anchorCol:f,leadingRow:b.Qr,leadingCol:b.Rr}),n(b,6,!1,e,f),c=!0):d&&(b=a.O2(b)),{sheet:b,r:c}},a.ey=function(b){return a.O2(b)},a.gy=function(b){return a.O2(b)},a.jy=function(b){var c,f,g,h=d.G0.H0;if(d&&h&&h._text&&(b=h.kj,c=h.nT,f=h.Mk,a.G2(b,!1),j(b),b.Sr(c,f,e,e,1),b.isEditing()))return g=b.getValue(c,f,3),!!b.gv(!0,void 0,void 0,!0)&&(b.setValue(c,f,g,3,!0),!0)},a}(),b.Commands.Wx=a}()},function(a,b,c){!function(){"use strict";var b=c(2),d=b.GC$,e=c(1),f=null,g=void 0,h=function(){function a(){var a=this;a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.kj=null,a.MH=!1,a.R2=-1,a.I0=null,a.OC=null,a.f1=null}return a.prototype={constructor:a,$b:function(){var a=this;a.S2(),a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.MH=!1,a.R2=-1,a.kj=null,a.OC=null,a.f1=null},S2:function(){var a,b,c=this;c.kj.Js||(a=c.kj.getCellType(c.nT,c.Mk),b={sheet:c.kj,row:c.nT,col:c.Mk,sheetArea:3},c.I0&&c.I0.firstChild&&a.deactivateEditor(c.I0.firstChild.firstChild,b)),d(c.I0).remove(),c.I0=null},T2:function(a){var b=this,c=a.Cw;c&&(b._text=c.text(),b.nT=a.getActiveRowIndex(),b.Mk=a.getActiveColumnIndex(),b.Q2=c.caret(),b.MH=c.MH,b.R2=c.C1(),b.V4=c.V4,b.C5=c.C5,b.Nfa=c.Nfa,b.kj=a,b.OC=a.parent,b.f1=a.mm.bG())},VF:function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1())},U2:function(a){var b=this,c=a.Cw;c&&(c.V4=b.V4,c.C5=b.C5,c.Nfa=b.Nfa,c.text(b._text),c.caret(b.Q2),b.MH&&(c.B1(),c.C1(b.R2)))},V2:function(a){var b,c=a.oldSheet,d=this,e=c.Cw;if(e)if(e.close(),(!d.kj||d.kj.Js)&&e.M0()||d.C5!==e.C5){d.T2(c),b=c.getValue(c.Jl,c.Kl,3),c.suspendEvent();try{if(!c.endEdit(!0))return}finally{c.resumeEvent()}c.setValue(c.Jl,c.Kl,b,3,!0),c.Px=1,a.needTriggerSheetChange=!1}else d._text&&(d.VF(c),e.destroy(),c.Cw=f,a.needTriggerSheetChange=!1)},W2:function(a){var b,c=a.oldSheet,d=a.newSheet,f=this;d.Js||(f.I0&&""===f._text&&(c.GJ(),f.$b()),f._text&&f.kj===d?(d.Px=0,d.Sr(f.nT,f.Mk,g,g,0),d.suspendEvent(),f.V4?(b=e.W4(d.parent.qo),e.J0(d,b),d.Px=2,d.yl.uH()):d.startEdit(!1),d.resumeEvent(),f.U2(d),f.VK(d,f.nT,f.Mk),c.GJ(),f.$b()):f._text&&!f.I0?(d.Px=1,c.Px=1,f.X2(d),d.EJ()):f._text&&f.kj!==d&&(d.Px=1,c.Px=1,f.X2(d),c.GJ(),d.EJ()))},X2:function(a){var b,c,g,h,i,j,k,l,m,n=this,o=n.kj;o.Js||(b=n.nT,c=n.Mk,g=o.getCellType(b,c),h={sheet:o,row:b,col:c,sheetArea:3,canvasOffset:this.f1},i=g.isImeAware(h),i&&(a.Px=1,j=g.a5(h),n.I0&&n.S2(),n.I0=j,d(j).css("position","absolute"),k=o.getCellRect(b,c),d(j).attr("id","across"),l=o.getActualStyle(b,c),g.d5(j,l,k,h),m=n.OC&&n.OC.getHost()||document.body,m.insertBefore(j,f),n.V4&&d(j).css({display:"none"}),e.J0(a,g.getEditingElement()),j.firstChild&&!n.V4&&g.focus(j.firstChild.firstChild),n.U2(a),g.g5(j,l,k,h)))},VK:function(a,b,c){var d,e=a.getCellType(b,c),f=a.BF,g=a.am(),h=a.getActualStyle(b,c),i=a.getCellRect(b,c);i&&i.width>0&&i.height>0&&i.x>=g.kt&&i.y>=g.nt&&i.x+i.width<=g.lt+g.js&&i.y+i.height<=g.ot+g.gs&&(d={sheet:a,row:b,col:c,sheetArea:3},f&&f.parentNode&&e.g5(f.parentNode.parentNode,h,i,d,!0))}},a}(),i=function(){function a(){}return a.Q0=function(a,b){e.G0.H0||(e.G0.H0=new h),e.G0.H0.V2(b)},a.R0=function(a,b){e.G0.H0||(e.G0.H0=new h),e.G0.H0.W2(b)},a}();e.G0=i,a.exports=e}()},function(a,b,c){!function(){"use strict";var a=c(2),b=c(4),d=c(1),e=a.GC$,f=e.extend,g=b.u,h=d.L0;f(a.oJ.prototype,{uH:function(){var a,b,c=this,d=c.kj;d.Xq>0||(a=d.am(),b=c.bm(),c.Mx(a.x,a.y,a.width,a.height),c.Pw(b))}}),a.Worksheet.$n("formulatextboxrender",{paintAdornment:function(a){var b,c,d,e=this,f=a.ctx,g=a.clipRect,h=e.yl,j=e.am(),k=e.mm._oa();if(k)for(c=0;c<=2;c++)for(d=0;d<=2;d++)b=j.Ft(c,d),b&&0!==b.width&&0!==b.height&&i(h,f,c,d,g,k)}});function i(a,c,e,f,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=a.kj,M=L.mm,N=j&&j.l1(),O=N&&N.length;if(!(O<=0)&&(k=a.VI(e,f,i))){for(c.save(),c.rect(k.x,k.y,k.width,k.height),c.clip(),c.beginPath(),l=[],m=M.isFormulaRangeHoving,n=M.tH,o=M.FG,p=M.K2,q=M.HG,r=M.L2,x=0;x<O;x++)if(s=N[x],t=s.text,u=s.ranges&&s.ranges.length>0?s.ranges:[h(L,t)]){if(y=d.G0.H0,y&&y.kj)if(g.Bb(t,"!")){if(z=g.Ib(t,"!"),L.name()!==z&&"'"+L.name()+"'"!==z)continue}else if(A=g.Ib(t,"["),B=L.tables,!(L.getCustomNames()[A]||B&&B.findByName(A)))continue;for(v=a.XI(e,f,u,k),C=0;C<v.length;C++)D=v[C],D&&D.width>0&&D.height>0&&(w=j.o1(x),j.t1(s)?(m&&n.paramRange.index===x&&(c.beginPath(),c.lineWidth=2,c.strokeStyle=w,c.rect(D.x+1,D.y+1,D.width-3,D.height-3),c.stroke()),a.fJ(c,D,w)):m&&n.paramRange.index===x||o&&p.paramRange.index===x||q&&r.paramRange.index===x?(c.beginPath(),c.lineWidth=2,c.strokeStyle=w,c.rect(D.x+1,D.y+1,D.width-3,D.height-3),c.stroke()):(c.beginPath(),c.lineWidth=2,c.strokeStyle=w,c.rect(D.x,D.y,D.width-1,D.height-1),c.stroke()),j.n1(s)&&(E=b.pc.ec(w),E.a=.1,c.beginPath(),c.fillStyle=b.pc.bc(E),c.fillRect(D.x+1,D.y+1,D.width-3,D.height-3)),l.push({rect:D,color:w,allowDrag:s.allowDrag}))}if(l.length>0&&j.UQa)for(F=l.length,x=0;x<F;x++)D=l[x].rect,w=l[x].color,G=5,H=D.x-2,I=D.x+D.width+1-G,J=D.y-2,K=D.y+D.height+1-G,l[x].allowDrag!==!1&&(y=d.G0.H0,y&&y._text||(c.beginPath(),c.fillStyle=w,c.fillRect(H,J,G,G),c.fillRect(I,J,G,G),c.fillRect(H,K,G,G),c.fillRect(I,K,G,G)));c.beginPath(),c.restore()}}}()},function(a,b){!function(){"use strict";function b(a,b){return{name:a,description:b}}a.exports={Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:[b("#All","Returns the entire contents of the table, or specified table columns including column headers, data and total rows."),b("#Data","Returns the data cells of the table or specified table columns."),b("#Headers","Returns the columns headers for the table, or specified table columns."),b("#Totals","Returns the total rows for the table or specified table columns."),b("@","This row.")]}}()}]);